'use strict';window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var si=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",si,void 0);var ti=function(a){return"urn:x-cast:com.google.cast."+a},ui=ti("tp.connection"),vi=ti("receiver"),wi=ti("media"),xi=ti("webrtc"),yi=Xb({aba:ui,bba:ti("tp.heartbeat"),uaa:vi,rL:wi,y$:ti("media.universalRemote.optIn"),tba:xi});var zi={s$:0,j$:1},Ai={oba:0,NL:1,vaa:2},Bi={DIAL:0,w$:1,x$:2,n9:3},Ci={S$:0,TIMEOUT:1,v9:2},Di={oz:0,F8:1,f9:2,I9:3,Z8:4,E$:5},Ei=function(a){kh("MediaRouter.Cast.Session.Ended",a,Ai)},Fi=function(a){kh("MediaRouter.Cast.Discovery.Type",a,Bi)},Gi=function(a){kh("MediaRouter.Cast.Session.Fail",a,Ci)};var Hi=function(a){return"available"==a||"available_rescan"==a};var Ii=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=e||null;this.domain=f||null;this.isLaunching_=!1};var Ji=function(a,b){this.cc=this.Ne=this.Rf=this.kb=this.la=null;this.nd=new Ii(Rf.O().Ap(b),a);this.Be={};this.zo={};this.$k=this.Ev=!1};d=Ji.prototype;d.ag=function(){return this.nd};d.Xl=function(){return this.nd.friendlyName};d.r4=function(a){this.cc=a;return this};d.getId=function(){return this.nd.id};d.Er=function(a){this.nd.id=a;return this};d.Gr=function(a){this.Ev=a;return this};d.qJ=function(a){this.$k=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.nd.friendlyName!=a.nd.friendlyName&&(this.nd.friendlyName=a.nd.friendlyName,b=!0);this.Rf!=a.Rf&&(this.Rf=a.Rf,b=!0);this.Ne!=a.Ne&&(this.Ne=a.Ne,b=!0);this.la!=a.la&&(this.la=a.la,b=!0);this.kb!=a.kb&&(this.kb=a.kb,b=!0);return b};d.X3=function(a){this.la=a;return this};d.ub=function(){return this.kb};d.Rk=function(a){this.kb=a;return this};d.u3=function(a){this.Rf=a;return this};d.t3=function(a){this.Ne=a;return this};
d.Kd=function(a){return this.Be[a]||"unknown"};d.DQ=function(a){return this.zo[a]||null};d.Cn=function(a,b){this.Be[a]=b;this.zo[a]=t();return this};d.WJ=function(){return"name = "+this.nd.friendlyName+(this.la?", ip = "+this.la:"")+(this.cc?", model = "+this.cc:"")+", apps = "+JSON.stringify(this.Be)};var Ki=function(a){var b=new Ji(a.nd.friendlyName,"");b.nd.id=a.nd.id;b.la=a.la;b.kb=a.kb;b.Rf=a.Rf;b.Ne=a.Ne;b.cc=a.cc;b.Be=a.Be;b.zo=a.zo;b.Ev=a.Ev;b.$k=a.$k;return b};var Mi=function(a,b,c,e,f,g){this.Wd=new Ii(Li(a),b,this.CD(e));this.cc=c||null;this.Zc=e||null;this.la=f||null;this.kb=g||null;this.Be={};this.Kl=!1},Li=function(a){return Rf.O().Ap(a)},Ni=function(a){if(!a.cc)return null;var b=a.cc;if(!a.la)return null;var c=a.la,e=a.ag().id,f;f=a.ag().friendlyName;f=-1!=f.indexOf("&")?"document"in h?Za(f):$a(f):f;b=new Mi(e,f,b,void 0,c,Rf.O().vl||8009);b.Wd.id=a.ag().id;b.yI(!0);return b};d=Mi.prototype;
d.update=function(a,b,c,e){var f=!1;this.Wd.friendlyName!=a&&(this.Wd.friendlyName=a,f=!0);this.la!=b&&(this.la=b,f=!0);this.kb!=c&&(this.kb=c,f=!0);this.Zc!=e&&(this.Zc=e,f=!0);return f};d.ag=function(){return this.Wd};d.Xl=function(){return this.Wd.friendlyName};d.CD=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.Z2=function(a){this.Zc=a;this.Wd.iconType=this.CD(this.Zc)};d.getId=function(){return this.Wd.id};d.ub=function(){return this.kb};
d.Kd=function(a){return this.Be[a]||"unknown"};d.Cn=function(a,b){this.Be[a]=b};d.WJ=function(){return"name = "+this.Wd.friendlyName+(this.la?", ip = "+this.la:"")+(this.cc?", model = "+this.cc:"")+", capabilities = "+this.Zc+", apps = "+JSON.stringify(this.Be)};d.yI=function(a){this.Kl=a};var Oi=function(a,b){this.se=b;this.nA=a;this.nA.W=this.W.bind(this);this.hh=r(this.iH,this);this.Fc=new A;this.Wk=new A;this.ef=new A;this.lw=null;this.xm=this.pg="";this.hj=null;this.jE=this.pm=!1};Oi.prototype.a=C("mr.cast.SinkDiscoveryService");var Pi={serviceType:"_googlecast._tcp.local"};d=Oi.prototype;d.init=function(){qf(this);this.pm&&(this.fF(),this.$B())};d.fF=function(){F(this.a,"Start listening to network changes");chrome.networkingPrivate.onNetworksChanged.addListener(this.$B.bind(this))};
d.start=function(){var a=t();if(chrome.mdns.onServiceList.hasListener(this.hh)){if(6E4>a-this.lw)return;F(this.a,"Forcing mdns discovery");this.lw=a;chrome.mdns.forceDiscovery(ya);chrome.mdns.onServiceList.removeListener(this.hh)}F(this.a,"Adding mdns listener");this.lw=a;chrome.mdns.onServiceList.addListener(this.hh,Pi)};d.stop=function(){F(this.a,"Removing mdns listener");chrome.mdns.onServiceList.removeListener(this.hh)};
d.PO=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return E(this.a,"Missing ID"),null;var e=Li(c),f=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(f)||0>f||65535<f)return E(this.a,"Missing or invalid port"),null;if(this.ef.Oa(e)){var g=this.ef.get(e);if(g.la==a.ipAddress&&g.ub()==f)return E(this.a,"Sink has pending connection "+
e),null;E(this.a,"Pending sink changed ip "+e);this.ef.remove(e)}g=b.fn;if(!g||!a.ipAddress)return E(this.a,"Missing friendly name or IP address"),null;var k=Number(b.ca),k=isNaN(k)?0:k;if(e=this.Fc.get(e))return e.update(g,a.ipAddress,f,k)&&(e.yI(!1),this.se.Qc(e)),null;e=b.md;return e?new Mi(c,g,e,k,a.ipAddress,f):(E(this.a,"Missing model name"),null)};d.refresh=function(){G(this.a,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(ya)};
d.iH=function(a){F(this.a,"Registering "+a.length+" devices");this.QO(a).forEach(this.LX,this)};d.sA=function(a,b){this.ef.Oa(a.getId())||(this.ef.set(a.getId(),a),this.wl(a).then(function(c){c?(c=this.Fc.get(a.getId()),b&&(c?c.Kl&&Fi(3):Fi(1)),this.ro(a)):F(this.a,"Inaccessible sink: "+a.getId())},null,this).Bb(function(){this.ef.remove(a.getId());0==this.ef.N()&&this.gr()},this))};d.LX=function(a){this.sA(a,!0)};d.QO=function(a){var b=[];a.forEach(function(a){(a=this.PO(a))&&b.push(a)},this);return b};
d.ro=function(a){F(this.a,"Adding sink "+a.getId());var b=this.Fc.get(a.getId()),c=null,e=a.la,f=a.ub();null!=e&&null!=f&&(c=this.Wk.get(e+":"+f));if(b&&!c){var g=a.la,k=a.ub();g&&k&&this.Wk.remove(g+":"+k)}c&&!b&&this.Fc.remove(c.getId());this.Fc.set(a.getId(),a);null!=e&&null!=f&&this.Wk.set(e+":"+f,a);this.pm||(this.pm=!0,this.fF());this.se.Zh(a);Rf.O().fi=new Qf(a.cc,a.la)};d.vw=function(a){F(this.a,"Channel error for sink "+a);this.ln(a)};
d.ln=function(a){var b=this.Fc.get(a);if(b){F(this.a,"Removing sink "+a);this.Fc.remove(a);a=b.la;var c=b.ub();null!=a&&null!=c&&this.Wk.remove(a+":"+c);this.se.Vq(b)}};d.b1=function(){var a=this.Fc.A();this.Fc.clear();this.Wk.clear();a.forEach(this.se.Vq,this.se)};d.wl=function(a){G(this.a,"Checking access to "+a.getId());return this.nA.aj(a).then(function(b){if(a.Kl){var c=4;b.audioOnly||(c|=1);a.Z2(c)}return!0},function(){return!1})};
d.gr=function(){F(this.a,"Pruning inactive sinks.");Gc(this.im(),function(a){this.ef.set(a.getId(),a);this.wl(a).then(function(b){b||this.ln(a.getId())},null,this).Bb(function(){this.ef.remove(a.getId())},this)},this)};d.W=function(a){return this.Fc.get(a,null)};d.GU=function(a,b){return this.Wk.get(a+":"+b)};d.HU=function(a){var b=[];Gc(this.im(),function(c){Hi(c.Kd(a))&&b.push(c)});return b};d.im=function(){return this.Fc.jv()};d.Qc=function(a){this.se.Qc(a)};d.mc=function(){return this.Fc.A()};
var Qi=function(a,b){this.sinkMap=a;this.networkIds=b;this.version=2},Ri=function(a){this.hasSavedSinks=a};d=Oi.prototype;d.Ra=function(){return"cast.SinkDiscoveryService"};d.getData=function(){var a={};Gc(this.Fc.TC(),function(b){var c;c=this.Fc.get(b);c={id:c.getId(),ip:c.la,port:c.ub(),friendlyName:c.Xl(),modelName:c.cc,capabilities:c.Zc};a[b]=c},this);return[new Qi(a,this.xm),new Ri(this.pm)]};
d.wb=function(){var a=nf(this);a&&2==a.version&&(this.xm=a.networkIds,this.jF(a.sinkMap));if(a=of(this))this.pm=a.hasSavedSinks};d.jF=function(a){this.jE=0<Object.keys(a).length;for(var b in a){var c;c=a[b];var e=new Mi("",c.friendlyName,c.modelName,c.capabilities,c.ip,c.port);e.Wd.id=c.id;c=e;this.W(c.getId())||this.sA(c,!1)}};
d.$B=function(){F(this.a,"Fetching networks state");this.hj&&yf(this.hj);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(a){for(var b=[],c=0;c<a.length;c++)"Connected"==a[c].ConnectionState&&b.push(a[c].GUID);this.w7(b.sort().join(","))}.bind(this))};
d.w7=function(a){F(this.a,"Update current network "+Si(a));a!=this.pg&&(this.hj&&(pf.remove(this.hj.Ra()),this.hj=null),a?(this.xm&&a!=this.xm?this.b1():this.gr(),this.xm=this.pg=a,this.hj=new Ti(this,this.pg)):this.pg="")};var Si=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},Ti=function(a,b){this.Vc=a;this.pg=b;qf(this)};Ti.prototype.Ra=function(){return"cast.NetworkSink."+this.pg};
Ti.prototype.getData=function(){var a=null,b=this.Vc.getData();b&&(this.Vc.jE||0<this.Vc.mc().length)&&(a=b[0]);F(this.Vc.a,"Saving sink data for network "+Si(this.pg));return[null,a]};Ti.prototype.wb=function(){F(this.Vc.a,"Restoring sink data for network "+Si(this.pg));var a=of(this);a&&2==a.version&&this.Vc.jF(a.sinkMap)};var Ui={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var Vi=function(){this.type="GET_STATUS";this.requestId=0};var Wi=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var Xi=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var Yi=function(a,b){this.requestId=a;this.g7=b;this.VJ=null};Yi.prototype.yw=function(){};var Zi=function(){this.Jb=new A};Zi.prototype.Cz=function(a){this.Jb.set(a.requestId,a);a.VJ=setTimeout(this.PZ.bind(this,a),a.g7)};Zi.prototype.jn=function(a){var b=this.Jb.get(a);if(!b)return null;clearTimeout(b.VJ);this.Jb.remove(a);return b};Zi.prototype.vh=function(a){return this.Jb.get(a,null)};Zi.prototype.PZ=function(a){this.Jb.remove(a.requestId);a.yw()};var aj=function(a){this.P6=a;this.kk=1E3*Math.floor(1E6*Math.random())};d=aj.prototype;d.tB=function(){qf(this)};d.Sp=function(){var a=this.kk++;0==a&&(a=this.kk++);return a};d.Ra=function(){return"IdGenerator."+this.P6};d.getData=function(){return[this.kk]};d.wb=function(){var a=nf(this);a&&(this.kk=a)};var bj=function(a,b){this.vc=a;this.Uc=b;this.bi=new Zi;this.wH=new aj("cast.RequestIdGenerator")};bj.prototype.init=function(){this.wH.tB()};var cj=function(a,b,c,e){Yi.call(this,a,c);this.mb=b;this.sourceId=e};u(cj,Yi);cj.prototype.yw=function(){this.mb.reject(dj)};bj.prototype.Dz=function(a,b,c){var e=this.wH.Sp();a.requestId=e;a=J();b=new cj(e,a,q(b)&&0<b?b:6E5,c);this.bi.Cz(b);return b};bj.prototype.sx=function(a){this.bi.jn(a.requestId)};bj.prototype.jn=function(a){return this.bi.jn(a)};
var dj=Error("Timeout"),ej=Error("Failed to send message");bj.prototype.sendRequest=function(a,b,c,e,f,g){if(!yi.hasOwnProperty(c))return I(Error("Custom namespace is not supported"));var k=this.Dz(a,l(e)?e:3E3,f),p=k.mb;this.vc.vr(b,c,a,f||this.Uc,g).then(null,function(){this.sx(k);p.reject(ej)},this);return p.promise};
bj.prototype.sendMessage=function(a,b,c,e,f,g){var k=this.Dz(a,l(e)?e:3E3,f),p=k.mb;this.vc.vr(b,c,a,f||this.Uc,g).then(function(){this.sx(k);p.resolve(!0)},function(){this.sx(k);p.reject(ej)},this);return p.promise};bj.prototype.A1=function(a,b){var c=new Wi(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,vi,a.requestSessionTimeout)};
bj.prototype.D1=function(a,b){return this.sendRequest(new Xi(a),b,vi)};var fj=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b};m("castApp.eventPage.Message",fj,void 0);var gj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};fj.DeviceData=gj;var hj=function(a,b){this.sc=a;this.$c=b;this.lj=new A;this.ih=new Sc;this.SE=0;this.WX=new A("serviceCheck",this.UV.bind(this),"startDeviceMonitor",this.bW.bind(this),"releaseDeviceMonitor",this.PV.bind(this));chrome.runtime.onMessage.addListener(this.KV.bind(this));chrome.runtime.onMessageExternal.addListener(this.EV.bind(this));this.qe("serviceReady")};d=hj.prototype;d.a=C("castApp.eventPage.Service");d.tL=3E4;
d.$V=function(){if(this.tA()){var a=new Sc;Gc(this.sc.im(),function(b){var e=b.la;a.add(e);this.lj.Oa(e)||this.$c.sendRequest(new Vi,b,vi)}.bind(this));var b=!1;this.lj.bb().forEach(function(c){a.contains(c)||(this.lj.remove(c),b=!0)}.bind(this));b&&this.nt()}};
d.xV=function(a,b){if(this.tA()&&yi.hasOwnProperty(b.namespace_)&&(a=a.la)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.lj.get(a);this.lj.set(a,new gj(a,b,e));c&&c.appId===b||this.nt()}};
d.tA=function(){if(0===this.ih.N())return!1;var a=t();if(a-this.SE>this.tL){this.SE=a;var b=[];chrome.extension.getViews().forEach(function(a){(a=a["castApp.eventPage.Message.OriginID"])&&b.push(a)}.bind(this));this.ih=this.ih.wE(b);F(this.a,"monitor client count: "+this.ih.N())}return 0<this.ih.N()};
d.KV=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.WX.get(a.subtype);if(!e)return!1;if(!a.originId)return hb("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){D(this.a,"Error while handling request",g)}return!1};d.qe=function(a,b){a=new fj(a,b);F(this.a,"Sending message: "+JSON.stringify(a));chrome.runtime.sendMessage(a)};d.UV=function(){this.qe("serviceReady")};
d.bW=function(a){F(this.a,"Registering monitor client: "+a.originId);this.ih.add(a.originId);this.nt();this.S0()};d.PV=function(a){F(this.a,"Unregistering monitor client: "+a.originId);this.ih.remove(a.originId)};d.nt=function(){var a=this.lj.A();this.qe("devices",a)};d.S0=function(){this.sc.refresh();this.sc.mc().forEach(function(a){this.$c.sendRequest(new Vi,a,vi)}.bind(this))};
d.EV=function(a,b,c){switch(a.type){case "handshake":c(new si("handshake"));break;case "launch":b=b.tab&&q(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome-extension://"+chrome.runtime.id+"/cast_setup/"+a.entryPoint+".html"})}};chrome.cast.xe={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.xe,void 0);chrome.cast.lo={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.lo,void 0);chrome.cast.zf={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.zf,void 0);chrome.cast.ye={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.ye,void 0);chrome.cast.OL={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.OL,void 0);chrome.cast.YL={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.YL,void 0);chrome.cast.no={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.no,void 0);chrome.cast.cL={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.cL,void 0);chrome.cast.ll={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.ll,void 0);chrome.cast.kz={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.kz,void 0);chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.V7=!0;m("chrome.cast.usingPresentationApi",chrome.cast.V7,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.XL=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.XL,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.VK=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.xe.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.lo.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.VK,void 0);chrome.cast.eL=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.eL,void 0);
chrome.cast.cz=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.cz,void 0);chrome.cast.dL=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.dL,void 0);chrome.cast.jz=function(a,b,c){this.appId=a;this.capabilities=Ca(b)?b:[chrome.cast.zf.VIDEO_OUT,chrome.cast.zf.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.jz,void 0);chrome.cast.Ks=function(a,b,c,e){this.label=a;this.friendlyName=b;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.no.CAST;this.displayStatus=this.isActiveInput=null};m("chrome.cast.Receiver",chrome.cast.Ks,void 0);chrome.cast.PL=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.PL,void 0);
chrome.cast.nz=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.nz,void 0);chrome.cast.timeout=new chrome.cast.nz;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.UK="auto-join";chrome.cast.gz="cast-session_";chrome.cast.media.kl={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.kl,void 0);chrome.cast.media.yd={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.yd,void 0);chrome.cast.media.mo={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.mo,void 0);
chrome.cast.media.Ls={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.Ls,void 0);chrome.cast.media.QL={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.QL,void 0);chrome.cast.media.lz={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.lz,void 0);
chrome.cast.media.kL={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.kL,void 0);chrome.cast.media.hM={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.hM,void 0);chrome.cast.media.eM={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.eM,void 0);
chrome.cast.media.aM={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.aM,void 0);chrome.cast.media.fM={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.fM,void 0);
chrome.cast.media.bM={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.bM,void 0);chrome.cast.media.cM={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.cM,void 0);chrome.cast.media.iL=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.iL,void 0);chrome.cast.media.BL=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.BL,void 0);chrome.cast.media.DL=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.DL,void 0);chrome.cast.media.WL=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.WL,void 0);
chrome.cast.media.ZL=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.ZL,void 0);chrome.cast.media.kM=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.kM,void 0);chrome.cast.media.nL=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.nL,void 0);
chrome.cast.media.gL=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.gL,void 0);chrome.cast.media.hL=function(){this.metadataType=this.type=chrome.cast.media.yd.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.hL,void 0);
chrome.cast.media.vL=function(){this.metadataType=this.type=chrome.cast.media.yd.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.vL,void 0);chrome.cast.media.iM=function(){this.metadataType=this.type=chrome.cast.media.yd.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.iM,void 0);chrome.cast.media.wL=function(){this.metadataType=this.type=chrome.cast.media.yd.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.wL,void 0);
chrome.cast.media.CL=function(){this.metadataType=this.type=chrome.cast.media.yd.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.CL,void 0);chrome.cast.media.uL=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.lz.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.uL,void 0);chrome.cast.media.FL=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.FL,void 0);chrome.cast.media.aL="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.aL,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.Qa=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.Qa;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.Sk=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.Sk;chrome.cast.media.timeout.$t=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.$t;chrome.cast.media.timeout.w0=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.w0;
chrome.cast.media.gM=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.gM,void 0);chrome.cast.media.dM=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.dM,void 0);chrome.cast.media.HL=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Ls.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.HL,void 0);chrome.cast.media.EL=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.EL,void 0);chrome.cast.media.LL=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.LL,void 0);chrome.cast.media.GL=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.GL,void 0);
chrome.cast.media.KL=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.KL,void 0);chrome.cast.media.IL=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.IL,void 0);
chrome.cast.media.JL=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.JL,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.mo.IDLE;this.currentTime=0;this.NE=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Ls.OFF};m("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.Qa=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.Qa;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;
chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.Sk=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.Sk;chrome.cast.media.u.prototype.$t=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.$t;chrome.cast.media.u.prototype.z0=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.z0;
chrome.cast.media.u.prototype.x0=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.x0;chrome.cast.media.u.prototype.J0=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.J0;chrome.cast.media.u.prototype.E0=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.E0;chrome.cast.media.u.prototype.D0=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.D0;
chrome.cast.media.u.prototype.A0=function(a){this.Iu(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.A0;chrome.cast.media.u.prototype.I0=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.I0;chrome.cast.media.u.prototype.G0=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.G0;chrome.cast.media.u.prototype.F0=function(a){this.Iu(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.F0;
chrome.cast.media.u.prototype.H0=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.H0;chrome.cast.media.u.prototype.C0=function(a,b,c,e){a=this.Iu(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.ye.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.C0;chrome.cast.media.u.prototype.X6=function(a){return-1<this.supportedMediaCommands.indexOf(a)};
chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.X6;chrome.cast.media.u.prototype.WR=function(){if(this.playerState==chrome.cast.media.mo.PLAYING&&0<=this.NE){var a=(t()-this.NE)/1E3,a=this.currentTime+this.playbackRate*a;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.WR;chrome.cast.media.u.prototype.Ws=function(){};
chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.Ws;chrome.cast.media.u.prototype.ux=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.ux;chrome.cast.media.u.prototype.Iu=function(a){return pb(this.items,function(b){return b.itemId==a})};var ij=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var jj=function(a){this.$c=a;this.a=C("mr.cast.ReceiverStatusQuerier")};jj.prototype.D6=function(a){return(new Sf(r(this.v0,this,a),3500,5)).Ar(2).start().na(function(b){F(this.a,"Failed to get receiver status from "+a.getId());throw b;},this)};jj.prototype.v0=function(a){F(this.a,"Query receiver status: "+a.getId());return this.$c.sendRequest(new Vi,a,vi)};var kj=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.T=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.kz.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.T,void 0);chrome.cast.T.prototype.i5=function(a,b,c){a=new kj(new chrome.cast.Volume(a,null),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverVolumeLevel=chrome.cast.T.prototype.i5;
chrome.cast.T.prototype.h5=function(a,b,c){a=new kj(new chrome.cast.Volume(null,a),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverMuted=chrome.cast.T.prototype.h5;chrome.cast.T.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.T.prototype.leave=chrome.cast.T.prototype.leave;chrome.cast.T.prototype.stop=function(){};chrome.cast.T.prototype.stop=chrome.cast.T.prototype.stop;chrome.cast.T.prototype.sendMessage=function(){};
chrome.cast.T.prototype.sendMessage=chrome.cast.T.prototype.sendMessage;chrome.cast.T.prototype.Ws=function(){};chrome.cast.T.prototype.addUpdateListener=chrome.cast.T.prototype.Ws;chrome.cast.T.prototype.ux=function(){};chrome.cast.T.prototype.removeUpdateListener=chrome.cast.T.prototype.ux;chrome.cast.T.prototype.BM=function(){};chrome.cast.T.prototype.addMessageListener=chrome.cast.T.prototype.BM;chrome.cast.T.prototype.AM=function(){};chrome.cast.T.prototype.addMediaListener=chrome.cast.T.prototype.AM;
chrome.cast.T.prototype.m1=function(){};chrome.cast.T.prototype.removeMediaListener=chrome.cast.T.prototype.m1;chrome.cast.T.prototype.n1=function(){};chrome.cast.T.prototype.removeMessageListener=chrome.cast.T.prototype.n1;chrome.cast.T.prototype.tX=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.loadMedia=chrome.cast.T.prototype.tX;chrome.cast.T.prototype.B0=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.queueLoad=chrome.cast.T.prototype.B0;var nj=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=lj(a);a=new chrome.cast.T(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||mj(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},oj=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.zf.VIDEO_OUT);a&2&&b.push(chrome.cast.zf.VIDEO_IN);a&4&&b.push(chrome.cast.zf.AUDIO_OUT);a&8&&b.push(chrome.cast.zf.AUDIO_IN);a&32&&b.push(chrome.cast.zf.MULTIZONE_GROUP);return b},lj=function(a){return new chrome.cast.Ks(a.getId(),a.Xl(),oj(a.Zc))},pj=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f=0;f<c.length;f++)if(!e.some(function(a){return a.name==c[f].name}))return!0;
return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},qj=function(a){Ca(a)?a.forEach(qj):Fa(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(Fa(a[b])||Ca(a[b]))&&qj(a[b])})},rj=function(a,b){return a.namespaces.some(function(a){return a.name==b})},sj=["MultizoneLeader","MultizoneFollower"],mj=function(a){return null!==a&&"MultizoneLeader"==a.appId},tj=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var uj=function(a){this.$c=a;this.a=C("mr.cast.SessionLauncher")};uj.prototype.ew=function(a,b){kh("MediaRouter.Cast.Session.Type",0,zi);return this.$c.A1(a,b).then(r(this.GV,this,b),function(a){a&&dj==a?Gi(1):Gi(0);return I(a)})};uj.prototype.GV=function(a,b){G(this.a,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Gi(2),Error(b.reason);a=nj(a,b.status);F(this.a,"Launched session: "+a.sessionId);return a};var vj=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var wj=function(a,b){this.tg=a;this.Db=b;this.Yj=[];this.bi=new Zi},xj=function(a,b){Yi.call(this,a,3E4);this.mb=b};u(xj,Yi);xj.prototype.yw=function(){this.mb.resolve(!1)};d=wj.prototype;d.a=C("mr.cast.ApiMessenger");d.Vp=function(a){return(a=this.Db.dd(a))?a.routeId:null};d.listen=function(a,b){this.Yj[a]=b};d.Jk=function(a,b,c){G(this.a,"Sending to "+b);G(this.a,JSON.stringify(c));c.clientId=b;this.tg.oP(a,c)};
d.pf=function(a,b){var c=this.Db.dd(a);c&&c.Bv?this.Jk(c.routeId,a,b):this.connect(a).then(function(c){c?(c=this.Vp(a))?this.Jk(c,a,b):E(this.a,"No route for "+a):E(this.a,"No connected client "+a)},null,this)};d.Pm=function(a){G(this.a,"App "+a);var b=this.Vp(a);if(b){if(b=this.bi.jn(b))(a=this.Db.dd(a))?(a.Bv=!0,b.mb.resolve(!0)):b.mb.resolve(!1)}else E(this.a,"No route for client "+a)};
d.lY=function(a){G(this.a,"Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.Pm(b):this.Vp(b)?(b=this.Yj[a.type])&&b(a):E(this.a,"No route for "+b)};d.connect=function(a){if(this.JW(a))return H(!0);var b=this.Vp(a);if(!b)return E(this.a,"No route for client "+a),H(!1);if(a=this.bi.vh(b))return a.mb.promise;var c=J();a=new xj(b,c);this.bi.Cz(a);return c.promise};d.JW=function(a){a=this.Db.dd(a);return null!=a&&a.Bv};var yj=function(a,b){this.pj=this.ve=this.Cg="";this.kb=null;this.Tf=this.qd="";this.hd=this.UW=!1;var c;a instanceof yj?(this.hd=l(b)?b:a.hd,this.Nr(a.Cg),this.iy(a.lm()),this.Nk(a.Xf()),this.Rk(a.ub()),this.Fg(a.qd),this.Jr(a.gf.clone()),this.Dr(a.Tf)):a&&(c=String(a).match(gf))?(this.hd=!!b,this.Nr(c[1]||"",!0),this.iy(c[2]||"",!0),this.Nk(c[3]||"",!0),this.Rk(c[4]),this.Fg(c[5]||"",!0),this.Jr(c[6]||"",!0),this.Dr(c[7]||"",!0)):(this.hd=!!b,this.gf=new zj(null,null,this.hd))};d=yj.prototype;
d.toString=function(){var a=[],b=this.Cg;b&&a.push(Aj(b,Bj,!0),":");var c=this.Xf();if(c||"file"==b)a.push("//"),(b=this.lm())&&a.push(Aj(b,Bj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.ub(),null!=c&&a.push(":",String(c));if(c=this.qd)this.qv()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Aj(c,"/"==c.charAt(0)?Cj:Dj,!0));(c=this.UR())&&a.push("?",c);(c=this.Tf)&&a.push("#",Aj(c,Ej));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.lW();c?b.Nr(a.Cg):c=a.mW();c?b.iy(a.lm()):c=a.qv();c?b.Nk(a.Xf()):c=a.jW();var e=a.qd;if(c)b.Rk(a.ub());else if(c=a.hE()){if("/"!=e.charAt(0))if(this.qv()&&!this.hE())e="/"+e;else{var f=b.qd.lastIndexOf("/");-1!=f&&(e=b.qd.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Ma(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var p=f[k++];"."==p?e&&k==f.length&&g.push(""):".."==p?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(p),e=!0)}e=g.join("/")}else e=f}c?b.Fg(e):c=a.kW();c?b.Jr(a.uR()):c=a.hW();c&&b.Dr(a.Tf);return b};d.clone=function(){return new yj(this)};d.Nr=function(a,b){this.lh();if(this.Cg=b?Fj(a,!0):a)this.Cg=this.Cg.replace(/:$/,"");return this};d.lW=function(){return!!this.Cg};d.lm=function(){return this.ve};d.iy=function(a,b){this.lh();this.ve=b?Fj(a):a;return this};d.mW=function(){return!!this.ve};d.Xf=function(){return this.pj};
d.Nk=function(a,b){this.lh();this.pj=b?Fj(a,!0):a;return this};d.qv=function(){return!!this.pj};d.ub=function(){return this.kb};d.Rk=function(a){this.lh();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.kb=a}else this.kb=null;return this};d.jW=function(){return null!=this.kb};d.Fg=function(a,b){this.lh();this.qd=b?Fj(a,!0):a;return this};d.hE=function(){return!!this.qd};d.kW=function(){return""!==this.gf.toString()};
d.Jr=function(a,b){this.lh();a instanceof zj?(this.gf=a,this.gf.Xx(this.hd)):(b||(a=Aj(a,Gj)),this.gf=new zj(a,null,this.hd));return this};d.UR=function(){return this.gf.toString()};d.uR=function(){return this.gf.h7()};d.Dr=function(a,b){this.lh();this.Tf=b?Fj(a):a;return this};d.hW=function(){return!!this.Tf};d.lh=function(){if(this.UW)throw Error("Tried to modify a read-only Uri");};d.Xx=function(a){this.hd=a;this.gf&&this.gf.Xx(a);return this};
var Fj=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Aj=function(a,b,c){return n(a)?(a=encodeURI(a).replace(b,Hj),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Hj=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Bj=/[#\/\?@]/g,Dj=/[\#\?:]/g,Cj=/[\#\?]/g,Gj=/[\#\?@]/g,Ej=/#/g,zj=function(a,b,c){this.Ia=this.gb=null;this.Sf=a||null;this.hd=!!c};
zj.prototype.Oe=function(){if(!this.gb&&(this.gb=new A,this.Ia=0,this.Sf)){var a=this;jf(this.Sf,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var Ij=function(a,b,c){b=Nc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new zj(null,null,c);a=Mc(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];Ca(g)?c.wJ(f,g):c.add(f,g)}return c};d=zj.prototype;d.N=function(){this.Oe();return this.Ia};
d.add=function(a,b){this.Oe();this.Uj();a=this.Bj(a);var c=this.gb.get(a);c||this.gb.set(a,c=[]);c.push(b);this.Ia+=1;return this};d.remove=function(a){this.Oe();a=this.Bj(a);return this.gb.Oa(a)?(this.Uj(),this.Ia-=this.gb.get(a).length,this.gb.remove(a)):!1};d.clear=function(){this.Uj();this.gb=null;this.Ia=0};d.Eb=function(){this.Oe();return 0==this.Ia};d.Oa=function(a){this.Oe();a=this.Bj(a);return this.gb.Oa(a)};d.cj=function(a){var b=this.A();return sb(b,a)};
d.bb=function(){this.Oe();for(var a=this.gb.A(),b=this.gb.bb(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.A=function(a){this.Oe();var b=[];if(n(a))this.Oa(a)&&(b=Bb(b,this.gb.get(this.Bj(a))));else{a=this.gb.A();for(var c=0;c<a.length;c++)b=Bb(b,a[c])}return b};d.set=function(a,b){this.Oe();this.Uj();a=this.Bj(a);this.Oa(a)&&(this.Ia-=this.gb.get(a).length);this.gb.set(a,[b]);this.Ia+=1;return this};
d.get=function(a,b){a=a?this.A(a):[];return 0<a.length?String(a[0]):b};d.wJ=function(a,b){this.remove(a);0<b.length&&(this.Uj(),this.gb.set(this.Bj(a),y(b)),this.Ia+=b.length)};d.toString=function(){if(this.Sf)return this.Sf;if(!this.gb)return"";for(var a=[],b=this.gb.bb(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.A(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.Sf=a.join("&")};d.h7=function(){return Fj(this.toString())};
d.Uj=function(){this.Sf=null};d.clone=function(){var a=new zj;a.Sf=this.Sf;this.gb&&(a.gb=this.gb.clone(),a.Ia=this.Ia);return a};d.Bj=function(a){a=String(a);this.hd&&(a=a.toLowerCase());return a};d.Xx=function(a){a&&!this.hd&&(this.Oe(),this.Uj(),this.gb.forEach(function(a,c){var e=c.toLowerCase();c!=e&&(this.remove(c),this.wJ(e,a))},this));this.hd=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)Pc(arguments[b],function(a,b){this.add(b,a)},this)};var Jj=function(a,b,c,e,f,g,k,p){this.$s=a;this.ad=b||null;this.Eo=c||null;this.ep=e||null;this.Aq=l(f)?f:null;this.at=g||null;this.hB=k||null;this.xv=p||!1},Kj=/(^\w+)(?:\(([\w,\ ]*)\))?$/,Lj=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},Mj=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:mb(x(a,function(a){a=Lj(a,"__castAppId__");if(!a)return null;a=a.match(Kj);if(!a||0==a.length)return null;var c=[];3==a.length&&a[2]&&(c=a[2].split(","));return{appId:a[1],capabilities:c}}),
function(a){return null!=a})},Nj=function(a){return Lj(a,"__castClientId__")};d=Jj.prototype;d.Rl=function(){return x(this.$s,function(a){return a.appId})};d.cC=function(){return this.at};d.Xb=function(){return this.ad};d.wu=function(){return this.Eo?this.Eo:chrome.cast.xe.TAB_AND_ORIGIN_SCOPED};d.vR=function(){return this.ep?this.ep:chrome.cast.lo.CREATE_SESSION};d.GS=function(){return null==this.Aq?chrome.cast.timeout.requestSession:this.Aq};
d.toString=function(){var a=new yj;a.Nr("https");a.Nk("google.com");a.Fg("/cast");var b=[];v(this.$s,function(a){var e="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(e=e+"("+a.capabilities.join(","),e+=")");b.push(e)});this.ad&&b.push("__castClientId__="+this.ad);this.Eo&&b.push("__castAutoJoinPolicy__="+this.Eo);this.ep&&b.push("__castDefaultActionPolicy__="+this.ep);null!=this.Aq&&b.push("__castLaunchTimeout__="+this.Aq);this.at&&b.push("__dialAppName__="+this.at);this.hB&&b.push("__dialPostData__="+
this.hB);this.xv&&b.push("__castInvisibleSender__=true");a.Dr(b.join("/"));return a.toString()};d.$W=function(a){var b=this.Rl(),c=Oj(a);return nb(b,function(a){return sb(c,a)})};
var Pj=function(a){var b=(new yj(a)).Tf;a=Mj(b);if(!a||0==a.length)return null;var c=Nj(b),e=Lj(b,"__castAutoJoinPolicy__"),f=Lj(b,"__castDefaultActionPolicy__"),g;g=Lj(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=Lj(b,"__dialAppName__"),p=Lj(b,"__dialPostData__"),b=Lj(b,"__castInvisibleSender__");return new Jj(a,c,e,f,g,k,p,null===b?null:"true"==b)},Oj=function(a){return(a=Pj(a))?a.Rl():null},Qj=function(a){return(a=Pj(a))?a.Xb():null};var Rj=function(a,b,c,e,f,g){this.kf=a;this.V=b;this.Db=c;this.ja=e;this.vc=f;this.tg=g;this.Hc=new wj(g,c);this.N0=new jj(this.kf);this.I2=new uj(this.kf)};d=Rj.prototype;d.a=C("mr.cast.ApiHandler");d.init=function(){this.Db.init();this.Hc.listen("v2_message",this.TZ.bind(this));this.Hc.listen("app_message",this.qY.bind(this));this.Hc.listen("leave_session",this.SY.bind(this))};d.Rd=function(a,b){this.Hc.lY(b)};
d.Ex=function(a,b,c,e){a=this.ja.oC(a);c&&0==a.length&&a.push(c.clientId);a.slice().forEach(function(a){a!=e&&this.WH(a,b)},this)};d.WH=function(a,b){b.clientId=a;this.Hc.pf(a,b)};d.ZH=function(a,b,c){b={receiver:lj(b),action:c};this.WH(a,new vj("receiver_action",b))};
d.TZ=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ja.cv(c);if(e)if(c=this.ja.DD(c))if(c=this.V.W(c))switch(b.type){case "STOP":this.nY(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":this.kY(a,c,e);break;case "SET_VOLUME":this.mY(a,c);break;default:E(this.a,"Unknown request")}else this.Hk(a,
chrome.cast.ye.INVALID_PARAMETER,"No receiver");else this.Hk(a,chrome.cast.ye.INVALID_PARAMETER,"No sink ID");else this.Hk(a,chrome.cast.ye.INVALID_PARAMETER,"Unknown session ID")}else this.Hk(a,chrome.cast.ye.INVALID_PARAMETER,"No session ID")};d.Hk=function(a,b,c){b=new chrome.cast.Error(b,c);this.Dx(a,b)};d.Dx=function(a,b){this.Hc.pf(a.clientId,new vj("error",b,a.sequenceNumber))};
d.nY=function(a,b){var c=a.message;jh("MediaRouter.Cast.Session.End");var e=c.sessionId,f=this.ja.Od(e);f&&(f.uq=!0);this.kf.sendRequest(c,b,vi,a.timeoutMillis,a.clientId).Bb(function(){this.tx(e,a)},this)};d.kY=function(a,b,c){var e=a.message,f=e.type;f in Ui&&(e.type=Ui[f]);this.kf.sendRequest(e,b,wi,a.timeoutMillis,a.clientId,c.transportId).then(function(b){this.WG(c,b);this.Hc.pf(a.clientId,new vj("v2_message",b,a.sequenceNumber))},function(b){this.Dx(a,b)},this)};
d.mY=function(a,b){var c=a.message;delete c.sessionId;this.kf.sendRequest(c,b,vi,a.timeoutMillis,a.clientId).then(function(){this.Hc.pf(a.clientId,new vj("v2_message",null,a.sequenceNumber))},function(b){this.Dx(a,b)},this)};
d.qY=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ja.DD(c);e?(e=this.V.W(e))?(c=this.ja.cv(c),qb(c.namespaces,function(a){return a.name==b.namespaceName})?this.vc.vr(e,b.namespaceName,b.message,a.clientId,c.transportId).then(function(){this.Hc.pf(a.clientId,new vj("app_message",null,a.sequenceNumber))},function(){this.Hk(a,chrome.cast.ye.CHANNEL_ERROR,"Channel to receiver not available")},this):this.Hk(a,chrome.cast.ye.INVALID_PARAMETER,"Invalid namespace")):E(this.a,"No receiver from sinkId"):
E(this.a,"No sinkId from sessionId")}else E(this.a,"No sessionId")};d.p1=function(a){a.td.slice().forEach(function(a){this.tg.xU(a)||this.tg.Ak(a,!0)}.bind(this))};d.Vq=function(a){(a=this.ja.em(a))&&a.session&&this.tx(a.session.sessionId)};
d.SY=function(a){F(this.a,"Leave session");var b=a.message,c=this.ja.Od(b);if(c){var e=a.clientId,f=this.Db.dd(e);if(f){var g=[],k=[],p=f.tabId,w=f.origin,B=f.autoJoinPolicy;c.Ge.forEach(function(a){var b=this.Db.dd(a);B==chrome.cast.xe.TAB_AND_ORIGIN_SCOPED&&p==b.tabId&&w==b.origin||B==chrome.cast.xe.ORIGIN_SCOPED&&w==b.origin?g.push(a):k.push(a)},this);this.Hc.pf(e,new vj("leave_session",null,a.sequenceNumber));g.forEach(function(a){this.Hc.pf(a,new vj("disconnect_session",b))},this);c.Ge=k}else E(this.a,
"No client record")}else E(this.a,"No session")};d.$G=function(a,b){rj(a,wi)&&this.kf.sendRequest(new Vi,b,wi,void 0,void 0,a.transportId).na(ya)};d.aH=function(a,b){var c=a.getId();F(this.a,"Query status for "+c);this.N0.D6(a).then(function(e){this.oG(c,e);b&&(e=this.ja.Xp(c))&&this.$G(e,a)},ya,this)};d.zZ=function(a,b){yi.hasOwnProperty(b.namespace_)?this.wZ(a,b):this.vZ(a,b)};
d.eX=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.vc.wD()||null!=this.Db.dd(a))return!0;F(this.a,"Invalid destination "+a);return!1};
d.wZ=function(a,b){G(this.a,"Cast message: "+JSON.stringify(b));if(this.eX(b))if(b.namespace_==xi)(a=this.ja.em(a))&&a.td.forEach(function(a){this.tg.nP(a,b)}.bind(this));else{var c=JSON.parse(b.data),e=this.NV(c),e=e?e.sourceId:void 0;switch(c.type){case "RECEIVER_STATUS":this.oG(a,c);break;case "MEDIA_STATUS":this.yZ(a,b,e)}}else this.vc.FA(a,b.destinationId,b.sourceId,!0)};
d.NV=function(a){var b=this.kf.jn(a.requestId);if(!b)return null;var c=b.mb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId,c.reject(new chrome.cast.Error(chrome.cast.ye.SESSION_ERROR,a.reason||a.type,a));default:c.resolve(a)}return b};
d.vZ=function(a,b){G(this.a,"App message: "+JSON.stringify(b));if(a=this.ja.Xp(a)){var c=[],c="*"==b.destinationId?this.ja.oC(a.sessionId):[b.destinationId],e=new ij(a.sessionId,b.namespace_,b.data);c.forEach(function(a){this.Hc.pf(a,new vj("app_message",e))},this)}else E(this.a,"No session for incoming app message")};
var Sj=function(a,b){a.forEach(function(a){a.sessionId=b;var e=a.supportedMediaCommands,f=[];e&1&&f.push(chrome.cast.media.kl.PAUSE);e&2&&f.push(chrome.cast.media.kl.SEEK);e&4&&f.push(chrome.cast.media.kl.STREAM_VOLUME);e&8&&f.push(chrome.cast.media.kl.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=Rj.prototype;d.WG=function(a,b){a=a.sessionId;b.sessionId=a;this.ja.z5(a,Sj(b.status,a))};d.dZ=function(a,b,c){this.Hc.pf(c,new vj("new_session",a));this.$G(a,b)};
d.kn=function(a){if(a=this.ja.Xp(a)){a=a.sessionId;var b=this.ja.Od(a);b&&b.uq||this.tx(a)}};d.tx=function(a,b){this.Ex(a,new vj("remove_session",a,b?b.sequenceNumber:void 0),b);(b=this.ja.Od(a))&&this.p1(b);this.ja.q1(a)};
d.oG=function(a,b){G(this.a,"Receiver status for "+a);var c=b.status;if(c)if(b=this.V.W(a)){var c=nj(b,c),e=this.ja.em(a);e?c?c.sessionId==e.session.sessionId?this.ZV(e,c):(this.aE(a),this.tg.be(null,b,null,c)):this.aE(a):c&&this.tg.be(null,b,null,c)}else jh("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),E(this.a,"Got message from receiver "+a+", but sink is no longer available.")};
d.ZV=function(a,b){var c=a.session;pj(c,b)&&(G(this.a,"Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.tg.H7(a),this.Ex(c.sessionId,new vj("update_session",c),void 0))};d.aE=function(a){this.kn(a,"receiver-app-end");Ei(1)};d.yZ=function(a,b,c){if(a=this.ja.Xp(a))if(b=JSON.parse(b.data))this.WG(a,b),this.Ex(b.sessionId,new vj("v2_message",b),void 0,c)};
d.eO=function(a,b){var c=oj(b.Zc);return(b=qb(a.$s,function(a){return ob(a.capabilities,function(a){return sb(c,a)})}))?b.appId:a.Rl()[0]};d.ew=function(a,b){var c=Pj(a);if(!c)return I(Error("Invalid source "+a));a=this.eO(c,b);var c=c.GS(),e=new bh("MediaRouter.Cast.Session.Launch");return this.I2.ew(new chrome.cast.jz(a,void 0,c),b).then(function(a){e.end("Success");return H(a)},function(a){e.end("Failure");return I(a)},this)};var Tj=C("mr.RuntimeErrorUtils"),Uj=function(){chrome.runtime.lastError&&Tj.LB(chrome.runtime.lastError.message||"unknown runtime error")};var Vj=function(){this.a=C("mr.cast.ChannelFactory");this.Qw=new A;this.Rw=new A;this.Wm=new A};d=Vj.prototype;d.aj=function(a,b){var c=a.getId(),e=a.la+":"+a.ub(),f=this.Qw.get(c);if(f){if(this.Wm.get(c)==e)return G(this.a,"Using pending creation to "+c),f;F(this.a,"Device "+c+" IP changed from "+this.Wm.get(a.getId())+" to "+e);this.mM(a)}a=this.sP(a,b).then(function(a){this.Dt(c);return a},function(a){e==this.Wm.get(c)&&this.Dt(c);return I(a)},this);this.Qw.set(c,a);this.Wm.set(c,e);return a};
d.mM=function(a){a=a.getId();G(this.a,"Aborting connection to device "+a);var b=this.Rw.get(a);b&&b.abort();this.Dt(a)};d.Dt=function(a){this.Qw.remove(a);this.Rw.remove(a);this.Wm.remove(a)};d.sP=function(a,b){if(1===b)return this.BG(a);var c=q(b)&&1<b?b:3;b=new Sf(r(this.BG,this,a),1E3,c);this.Rw.set(a.getId(),b);return b.Ar(1.5).start().then(null,function(b){F(this.a,"Failed to create channel to "+a.getId()+" after "+c+" attempts.");return I(b)},this)};
d.BG=function(a){var b=Wj++;F(this.a,"Connecting to (id "+b+") "+a.getId());var c=new bh("MediaRouter.Cast.Mdns.Channel.Open");return this.VZ(a).then(function(a){F(this.a,"Channel opened (id "+b+"): "+JSON.stringify(a));c.end("Success");return a},function(a){F(this.a,"Channel did not open (id "+b+").");c.end("Failure");return I(a)},this)};var Wj=0;
Vj.prototype.VZ=function(a){a={ipAddress:a.la,port:a.ub(),auth:"ssl_verified",timeout:1E4,livenessTimeout:1E4,pingInterval:5E3,capabilities:0};F(this.a,"Opening channel to "+JSON.stringify(a));var b=J();chrome.cast.channel.open(a,r(function(a){Uj();"open"==a.readyState?b.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this)),b.reject(Error(a.errorState)))},this));return b.promise};var Xj=function(a,b,c,e){return{namespace_:a,data:n(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var Zj=function(a){this.type="CONNECT";this.origin={};this.userAgent=hc;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:qi,platform:Yj(),systemVersion:b,connectionType:1};this.connType=a?0:2},Yj=function(){switch(ph()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var ak=function(){this.we=new A};za(ak);d=ak.prototype;d.init=function(){qf(this)};d.Gw=function(a,b,c,e){this.EA(a,b,c,!1);var f=Xj(ui,new Zj(e),b,c);chrome.cast.channel.send(a,f,r(this.WB,this));this.we.set(this.Ov(a,b,c),e)};d.EA=function(a,b,c,e){if(this.lE(a,b,c)){var f=0;this.we.forEach(function(a,b){b=b.split("#")[2];a&&b==c&&f++});if(e||1<f)this.sH(a,b,c),b=Xj(ui,{type:"CLOSE"},b,c),chrome.cast.channel.send(a,b,r(this.WB,this))}};d.sH=function(a,b,c){this.we.remove(this.Ov(a,b,c))};
d.s1=function(a){this.we.bb().forEach(function(b){b.split("#")[0]==a.channelId.toString()&&this.we.remove(b)},this)};d.eY=function(a,b){this.we.forEach(function(c,e){var f=e.split("#");f[0]==a.channelId.toString()&&(this.Gw(b,f[1],f[2],c),this.we.remove(e))},this)};d.LP=function(a,b,c){this.lE(a,b,c)||this.Gw(a,b,c,0==c.indexOf("receiver-0"))};d.lE=function(a,b,c){return this.we.Oa(this.Ov(a,b,c))};d.WB=function(){Uj()};d.Ov=function(a,b,c){return[a.channelId,b,c].join("#")};
var bk=function(a){this.GK=a};ak.prototype.Ra=function(){return"cast.VirtualConnectionManager"};ak.prototype.getData=function(){var a=this.we.b();return[new bk(a)]};ak.prototype.wb=function(){var a=nf(this);if(a)for(var b in a.GK)this.we.set(b,a.GK[b])};var ck=function(a,b){this.At=b;this.Uc=a;this.a=C("mr.cast.ChannelService");this.xg=new A;this.Hf=new A;this.Hi=ak.O();this.WN=new Vj;this.W=null};d=ck.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(r(this.xY,this));chrome.cast.channel.onError.addListener(r(this.vY,this));this.Hi.init();qf(this)};d.wD=function(){return this.Uc};d.vr=function(a,b,c,e,f){var g=e||this.Uc,k=f||"receiver-0";return this.aj(a).then(function(a){return this.B2(a,b,c,g,k)},null,this)};
d.WZ=function(a,b,c,e){return this.aj(a).then(function(a){this.Hi.Gw(a,b,c,e)},null,this)};d.FA=function(a,b,c,e){(a=this.xg.get(a))&&this.Hi.EA(a,b,c,e)};
d.xY=function(a,b){var c=this.Hf.get(a.channelId);if(c){var e=this.W(c);if(e){if(yi.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.Hi.sH(a,b.destinationId,b.sourceId);return}F(this.a,"Got message "+(c.type||c.responseType)+" from "+e.getId())}else F(this.a,"Got message in "+b.namespace_+" from "+e.getId());this.At.wY(e,b)}else E(this.a,"Receiver "+c+" not found.")}else E(this.a,"This message is from unknown receiver.")};
d.GA=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this));var b=this.Hf.get(a.channelId);b&&(this.Hf.remove(a.channelId),this.xg.remove(b))};d.vY=function(a,b){E(this.a,"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):""));b&&this.vM(b.errorState,b);this.DA(a)};
d.vM=function(a,b){switch(a){case "unknown":a=0;break;case "authentication_error":a=1;break;case "connect_error":a=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)a=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)a=4;-138==b.netReturnValue&&(a=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)a=1}E(this.a,"Channel error code: "+a);kh("MediaRouter.Cast.Channel.Error",a,Di)};d.DA=function(a){var b=this.Hf.get(a.channelId);this.GA(a);if(b){var c=this.W(b);c&&this.aj(c).then(function(b){F(this.a,"Re-connected to receiver: "+c.getId());this.Hi.eY(a,b);this.At.yY(c)},function(){F(this.a,"Failed to re-connect to receiver: "+c.getId());this.Hi.s1(a);this.At.vw(c,a.errorState)},this)}};
d.aj=function(a){var b=a.getId(),c=this.xg.get(b);return c&&"open"==c.readyState?H(c):this.WN.aj(a).then(function(a){if(this.Hf.Oa(a.channelId))return a;this.xg.get(b)&&(E(this.a,"Duplicate channel to a receiver "+b),this.GA(this.xg.get(b)));F(this.a,"Connected to: "+b);this.xg.set(b,a);this.Hf.set(a.channelId,b);return a},null,this)};
d.B2=function(a,b,c,e,f){this.Hi.LP(a,e,f);qj(c);var g=Xj(b,c,e,f);F(this.a,"Channel is sending message");G(this.a,"....message was: "+JSON.stringify(g));return new ie(function(b,c){chrome.cast.channel.send(a,g,r(function(a){Uj();a.errorState?(c(Error("Failed to send message")),this.DA(a)):b(!0)},this))},this)};var dk=function(a,b){this.M0=a;this.XN=b};ck.prototype.Ra=function(){return"cast.ChannelService"};ck.prototype.getData=function(){return[new dk(this.xg.b(),this.Hf.b())]};
ck.prototype.wb=function(){var a=nf(this);a&&(this.xg.addAll(a.M0),this.Hf.addAll(a.XN))};var ek=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var fk=function(a,b){this.kf=a;this.V=b;this.Jb=new Sc;this.gc=new A};d=fk.prototype;d.a=C("mr.cast.AppDiscoveryService");d.init=function(){qf(this)};d.jx=function(a){var b=this.gc.get(a);b?b.lx++:this.gc.set(a,{lx:1});this.k2()};d.Ey=function(a){var b=this.gc.get(a);b&&(b.lx--,0<b.lx||(Gc(this.V.im(),function(b){switch(b.Kd(a)){case "available":b.Cn(a,"available_rescan");break;case "unavailable":b.Cn(a,"unavailable_rescan")}}),this.gc.remove(a)))};
d.k2=function(){F(this.a,"Scanning sinks for app availability");Gc(this.V.im(),this.vn,this)};
d.vn=function(a){Gc(this.gc.TC(),function(b){var c;a:{switch(a.Kd(b)){case "unknown":case "available_rescan":case "unavailable_rescan":c=!0;break a}c=!1}if(c){var e=a.getId()+":"+b;this.Jb.contains(e)||(this.Jb.add(e),(new Sf(this.$N.bind(this,a,b),5500,3)).Ar(2).start().then(this.mK.bind(this,a,b),function(){D(this.a,"Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");this.mK(a,b,"unknown")},this).Bb(function(){this.Jb.remove(e)},this))}},this)};
d.mK=function(a,b,c){c!=a.Kd(b)&&(F(this.a,b+" on "+a.getId()+" is "+c),a.Cn(b,c),this.V.Qc(a))};
d.$N=function(a,b){var c=new ek;c.appId=[b];var e=new bh("MediaRouter.Cast.App.Availability");return this.kf.sendRequest(c,a,vi,5E3).then(function(a){e.end("Success");G(this.a,"App availability response "+JSON.stringify(a));for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(c){e.end("Failure");D(this.a,"checkAppAvailability_ failed for "+a.getId()+", appId "+b);throw c;},this)};
var gk=function(a){this.Z0=a};fk.prototype.Ra=function(){return"cast.AppDiscoveryService"};fk.prototype.getData=function(){return[new gk(this.gc.b())]};fk.prototype.wb=function(){var a=nf(this);a&&this.gc.addAll(a.Z0)};var hk=function(a,b){this.sinks=a;this.origins=b||null},ik=new hk([]);var jk=function(){},kk=function(a){if(!Ma(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=fb(b,"/",2);if(3!=b.length)return null;var c=fb(b[1],"-",1);if(2!=c.length)return null;var e=new jk;e.ika=a;e.QG=b[0];e.rja=c[0];e.Eka=c[1];e.Ig=b[2];return e};jk.prototype.da=function(){return this.Ig};var lk=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.fj=e},mk=function(a,b,c,e,f,g,k){return new lk("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var nk=function(a,b,c,e){return mk(c,"cast",b.getId(),a,e,"",null)};var ok=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.Bv=!1},pk=function(){this.lb=[]};d=pk.prototype;d.init=function(){qf(this)};d.N=function(){return this.lb.length};d.dd=function(a){return qb(this.lb,function(b){return b.clientId==a})};d.dg=function(a){return qb(this.lb,function(b){return b.routeId==a})};d.Rs=function(a,b,c,e,f,g){a=new ok(a,b,c,e,f,g);this.lb.push(a);return a};
d.qx=function(a){this.lb=mb(this.lb,function(b){return b.clientId!=a})};var qk=function(a){this.mr=a};pk.prototype.Ra=function(){return"cast.ClientRecords"};pk.prototype.getData=function(){return[new qk(this.lb)]};pk.prototype.wb=function(){var a=nf(this);a&&(this.lb=a.mr)};var rk=function(a){this.V=a},sk=function(a){var b=[];a.forEach(function(a){var e="Receiver-"+a.replace(/\./g,"_"),f=Rf.O().vl||8009;b.push({serviceName:e+"._googlecast._tcp.local",serviceHostPort:e+":"+f,ipAddress:a,serviceData:["id=mdns:"+e,"ve=02","ca=5","st=1","fn="+e,"md=Chromecast"]})});return b};rk.prototype.init=function(){var a=sk(Rf.O().pu);this.V.iH(a)};var tk=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var uk=function(a,b){this.Ge=[];this.td=[];this.sinkId=a;this.session=b;this.Bq=this.Dm=null;this.offTheRecord=this.uq=!1};d=uk.prototype;d.Rs=function(a){if(sb(this.Ge,a))return!1;this.Ge.push(a);return!0};d.qx=function(a){return xb(this.Ge,a)};d.be=function(a){if(sb(this.td,a))return!1;this.td.push(a);return!0};d.Ak=function(a){return xb(this.td,a)};d.qV=function(a,b){mj(a)?(this.Bq=a,this.Dm=b):mj(this.session)&&(this.Bq=this.session,this.Dm=this.sinkId,this.session=a,this.sinkId=b);return this};
var vk=function(){this.a=C("mr.cast.SessionRecords");this.lb=[]};d=vk.prototype;d.init=function(){qf(this)};d.Us=function(a,b){F(this.a,"Adding new session: "+b+", "+a.sessionId);var c=this.Od(a.sessionId);if(c)return c.qV(a,b);a=new uk(b,a);this.lb.push(a);return a};d.q1=function(a){F(this.a,"Removing session "+a);this.lb=mb(this.lb,function(b){return b.session.sessionId!=a})};d.oC=function(a){return(a=this.Od(a))?a.Ge:[]};d.Xp=function(a){return(a=this.em(a))?a.session:null};
d.dd=function(a){return qb(this.lb,function(b){return sb(b.Ge,a)})};d.dg=function(a){return qb(this.lb,function(b){return sb(b.td,a)})};d.aU=function(a){return qb(this.lb,function(b){return null!=qb(b.td,function(b){return kk(b).QG==a})})};d.em=function(a){return qb(this.lb,function(b){return b.sinkId==a||b.Dm==a})};d.Od=function(a){return qb(this.lb,function(b){return b.session.sessionId==a})};d.DD=function(a){return(a=this.Od(a))?a.sinkId:null};d.cv=function(a){return(a=this.Od(a))?a.session:null};
d.z5=function(a,b){var c=this.cv(a);c&&(a=mb(b,function(a){return a.playerState!=chrome.cast.media.mo.IDLE},this),a.forEach(function(a){if(!a.media){var b=qb(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.q0=function(a){for(var b=0;b<this.lb.length;b++)this.lb[b].qx(a)};var wk=function(a){this.mr=a};vk.prototype.Ra=function(){return"cast.SessionRecords"};vk.prototype.getData=function(){return[new wk(this.lb)]};
vk.prototype.wb=function(){var a=nf(this);if(a)for(var b=0;b<a.mr.length;b++){var c=a.mr[b],e=new uk(c.sinkId,c.session);e.Ge=c.Ge;e.td=c.td;e.uq=c.uq;e.Bq=c.Bq;e.Dm=c.Dm;this.lb.push(e)}};var xk=function(a){this.Uc="sender-"+bb();this.$a=new A;this.Kh=null;qf(this);this.C=a;this.Db=new pk;this.ja=new vk;this.vc=new ck(this.Uc,this);this.V=new Oi(this.vc,this);this.$O=new rk(this.V);this.$c=new bj(this.vc,this.Uc);this.Ic=new fk(this.$c,this.V);this.Yc=new Rj(this.$c,this.V,this.Db,this.ja,this.vc,this);this.mA=new hj(this.V,this.$c);this.z6=this.V.start.bind(this.V)};d=xk.prototype;d.a=C("mr.CastProvider");d.getName=function(){return"cast"};
d.jd=function(){this.$c.init();this.ja.init();this.Yc.init();this.vc.init();this.V.init();this.$O.init();this.Ic.init();this.C.kx(this.z6)};d.Ve=function(){return this.$a.A()};d.Sl=function(a){var b=new Sc;this.Fp(a).forEach(function(a){this.V.HU(a).map(function(a){return a.ag()}).forEach(function(a){b.add(a)})}.bind(this));return new hk(b.A(),-1!=a.indexOf("0F5096E8")?uh:null)};d.Bi=function(a){this.Fp(a).forEach(function(a){this.Ic.jx(a)}.bind(this));this.C.Fv()&&this.V.start()};d.Di=function(a){this.Fp(a).forEach(function(a){this.Ic.Ey(a)}.bind(this))};
d.Ai=function(){};d.Ci=function(){};d.W=function(a){return(a=this.V.W(a))?a.ag():null};d.r2=function(a){var b=new ah(tk,"warning","dismiss");b.routeId=a;this.C.Se().send(b)};d.$D=function(a,b){D(this.a,"Error launching.",b);this.r2(a.id);this.C.onPresentationConnectionClosed(a.id,"error","Launch error");this.Ak(a.id,!1)};
d.jp=function(a,b,c,e,f,g,k){Rf.O().gi=new Qf(b.cc,b.la);var p=nk(a,b,c,!0);p.forDisplay=!1;p.offTheRecord=e;this.$a.set(p.id,p);this.C.pk(this,p);(e=Pj(a))&&e.Xb()&&this.uz(e,p.id,g,k);th(a)?(p.oe={tabId:k,sessionId:"",AJ:b.la||"",BJ:b.cc||""},this.C.On(this,p,function(e){return this.cF(a,b,c,f,g,k,e)}.bind(this)).then(function(){this.UI(p)},function(a){this.$D(p,a)},this)):this.cF(a,b,c,f,g,k,p).na(function(a){this.$D(p,a)},this);return H(p)};
d.cF=function(a,b,c,e,f,g,k){return this.Yc.ew(this.Vw(a,b,e),b).then(function(e){this.be(a,b,c,e,f,g,k);return k},null,this)};d.ee=function(a,b,c,e,f,g,k){var p=this.V.W(b);if(!p)return I(Error("No sink with ID "+b));var w=Nj(a);if(w){setTimeout(function(){this.Yc.ZH(w,p,chrome.cast.ll.CAST)}.bind(this),0);var B=this.Db.dd(w);if(B)return this.tc(B.routeId).then(function(){return this.jp(a,p,c,e,f,g,k)},null,this);if(g&&k&&(b=this.VA(a,g,k,e,f,b)))return b}return this.jp(a,p,c,e,f,g,k)};
d.oP=function(a,b){this.C.Rd(this,a,b)};d.nP=function(a,b){var c=this.$a.get(a);c&&c.fj&&this.C.Tq(this,a,b)};d.Ak=function(a,b){F(this.a,"Remove route "+a);var c=this.Db.dg(a);if(c){var e=c.clientId;F(this.a,"Remove client "+e);this.ja.q0(e);this.Db.qx(e)}if(e=this.ja.dg(a))e.Ak(a),this.tF(e.td);var f=this.$a.get(a);f&&(f.fj&&e&&(this.vc.FA(f.sinkId,c?c.clientId:this.Uc,e.session.transportId,b),f.forDisplay&&c&&(this.Kh={Yi:c,dI:e})),this.$a.remove(a),this.C.Xh(this,f))};
d.H7=function(a){a.td.forEach(function(b){if(b=this.$a.get(b)){var c=a.session;b.oe&&b.forDisplay?this.UI(b):(b.description=c.statusText||c.displayName,this.C.Yh(this,b))}}.bind(this))};d.A7=function(a){nb(a,function(a){a=this.$a.get(a,null);if(!a||!a.mediaSource)return!1;var c=Pj(a.mediaSource),c=c?c.xv:!1;return a.isLocal&&!c},this)&&v(a,function(a){if(a=this.$a.get(a,null))a.isLocal=!0},this)};
d.tF=function(a){var b=[],c=[],e=null;a.forEach(function(a){if(a=this.$a.get(a)){a.forDisplay=!1;var g=Pj(a.mediaSource);g&&qb(g.Rl(),tj)||(a.fj?(g=g?g.wu():null,e||g==chrome.cast.xe.CUSTOM_CONTROLLER_SCOPED||(b.push(a),e=a.sinkId)):e&&e!=a.sinkId?b.push(a):c.push(a))}}.bind(this));v(0<b.length?b:c,function(a){a.forDisplay=!0})};d.uz=function(a,b,c,e){var f=a.Xb();f&&!this.Db.dd(f)&&(F(this.a,"Add client "+f),this.Db.Rs(b,f,a.Rl(),a.wu(),c||null,l(e)?e:null))};
d.UI=function(a){var b=this.ja.dg(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.be=function(a,b,c,e,f,g,k){var p=null!=a,w;null==a?(w=new Jj([{appId:e.appId,capabilities:e.capabilities}]),a=w.toString()):w=Pj(a);a=k||nk(a,b,c||e.sessionId,p);p=a.id;F(this.a,"Add route "+p);c=null;w&&(c=w.Xb(),this.uz(w,p,f,g));(f=this.ja.em(b.getId()))||(f=this.ja.Us(e,b.getId()));f.be(p);a.fj&&this.vc.WZ(b,c||this.Uc,e.transportId,!(w&&w.xv));f.offTheRecord=a.offTheRecord;this.$a.set(p,a);w=f.td;this.A7(w);this.tF(w);w=e.sessionId;g=e.appId;("0F5096E8"==g||"85CDB22F"==g)&&w&&a.oe&&(a.oe.sessionId=
w);!rj(e,wi)||null!==e&&sb(sj,e.appId)||(a.customControllerPath="cast_route_details.html?"+["sessionId="+w,"appId="+g].join("&"));a.description=e.statusText||e.displayName;k?this.C.Yh(this,a):this.C.pk(this,a);c&&f.Rs(c)&&this.Yc.dZ(e,b,c);return a};
d.tc=function(a){var b=this.$a.get(a);if(!b)return H();var c=this.ja.dg(a);if(!c)return F(this.a,"Session for route "+a+" does not exist."),this.Ak(a,!0),H();var e=this.V.W(b.sinkId);if(!e)return F(this.a,"Sink for route "+a+" is no longer reachable."),this.Yc.kn(c.sinkId,"close-route"),H();(a=this.Db.dg(a))&&this.Yc.ZH(a.clientId,e,chrome.cast.ll.STOP);Ei(0);var f=J();this.$c.D1(c.session.sessionId,e).Bb(function(){this.Yc.kn(e.getId(),"close-route");f.resolve()},this);return f.promise};
d.oQ=function(a){var b=null;Hc(this.$a.jv(),function(c){if(!c.fj)return!1;var e=this.V.W(c.sinkId);if(!e||!a.$W(this.Vw(c.mediaSource,e)))return!1;b=c;return!0},this);if(!b||!b.mediaSource)return null;var c=Qj(b.mediaSource);if(!c)return null;var e=this.Db.dd(c);return e?(c=this.ja.dd(c))?{Yi:e,dI:c}:null:null};
d.SM=function(a,b,c){var e=this.oQ(a);if(!e){if(!this.Kh||this.Kh.Yi.origin!=b||this.Kh.Yi.tabId!=c)return null;e=this.Kh}switch(a.wu()){case chrome.cast.xe.PAGE_SCOPED:return null;case chrome.cast.xe.ORIGIN_SCOPED:if(b!=e.Yi.origin)return null;break;case chrome.cast.xe.TAB_AND_ORIGIN_SCOPED:if(b!=e.Yi.origin||c!=e.Yi.tabId)return null}return this.ja.Od(e.dI.session.sessionId)};
d.VA=function(a,b,c,e,f,g){var k=null;Hc(this.$a.jv(),function(a){var b=a.oe;return b&&null!=b.tabId&&b.tabId==c&&sh(a.mediaSource)?(k=a,!0):!1});return k?this.tc(k.id).then(function(){return this.ee(a,g||k.sinkId,"",e,f,b,null==c?void 0:c)},null,this):null};
d.ah=function(a,b,c,e,f){if(!Pj(a))return I(Error("Unsupported presentation URL"));b=kk(b);b=this.ja.Od(b.QG);if(!b)return I(Error("No matching route"));var g=this.V.W(b.sinkId);if(!g)return I(Error("No sink"));a=this.be(a,g,c,b.session,e,f);return H(a)};
d.Ih=function(a,b,c,e,f,g){var k=Pj(a);if(!k)return I(Error("Unsupported presentation URL"));var p;if(b==chrome.cast.UK){if(p=this.SM(k,f,g),!p&&k.vR()!=chrome.cast.lo.CAST_THIS_TAB&&(e=this.VA(a,f,g,c,e)))return e}else p=0==b.indexOf(chrome.cast.gz)?this.ja.Od(b.substr(chrome.cast.gz.length)):this.ja.aU(b);if(!p)return I(Error("No matching route"));if(p.offTheRecord!=c)return I(Error("Off the record mismatch"));e=this.V.W(p.sinkId);if(!e)return I(Error("No sink"));a=this.be(a,e,b,p.session,f,g);
a.offTheRecord=c;return H(a)};d.Qf=function(a){this.Ak(a,!1)};d.$f=function(a){var b=!0,c=!0;if(a=this.V.W(a))b=a.Zc,c=!!(b&1),b=!!(b&4);return ci(b,c)};d.$l=function(){return"cast_streaming"};
d.Dg=function(a,b,c){if(!c)return this.Yc.Rd(a,b),H();var e=this.ja.dg(a);if(!e)return I(Error("Not managing the route "+a));var f=this.V.W(e.sinkId);if(!f)return I(Error("Sink no longer accessible"));a=(a=this.Db.dg(a))?a.clientId:this.Uc;var g=J();this.vc.vr(f,c.namespace,b,a,e.session.transportId).Bb(function(){g.resolve()});return g.promise};d.ul=function(a,b){var c=this.V.W(b);if(!c)return!1;a=this.Vw(a,c);return(a=Oj(a))&&0!=a.length?nb(a,function(a){return Hi(c.Kd(a))}):!1};
d.Ui=function(a,b){var c=this.Fp(a);return c&&0!=c.length?b&&b.mediaSource?(a=Oj(b.mediaSource),nb(a,function(a){return sb(c,a)},this)):!0:!1};d.xU=function(a){return(a=this.$a.get(a))?Nj(a.mediaSource):null};d.Vw=function(a,b,c){return th(a)?(a={appId:0==(b.Zc&1)?"85CDB22F":"0F5096E8",capabilities:oj(b.Zc)},(new Jj([a],void 0,void 0,void 0,c)).toString()):a};d.Fp=function(a){var b=[];th(a)?(b.push("85CDB22F"),b.push("0F5096E8")):(a=Oj(a))&&(b=Bb(b,a));return b};
d.vw=function(a){this.V.vw(a.getId());Ei(2)};d.yY=function(a){this.Yc.aH(a,!0)};d.wY=function(a,b){this.mA.xV(a,b);this.Yc.zZ(a.getId(),b)};d.Zh=function(a){this.C.onSinkAvailabilityUpdated(this,1);this.Qc(a);this.Yc.aH(a)};d.Vq=function(a){if(0==this.V.mc().length)this.C.onSinkAvailabilityUpdated(this,0);this.Yc.Vq(a.getId());this.bE()};d.Qc=function(a){this.Ic.vn(a);this.bE()};d.bE=function(){this.mA.$V();this.C.rc()};var yk=function(a,b,c){this.bI=a;this.routes=b;this.iX=c};xk.prototype.Ra=function(){return"cast.Provider"};
xk.prototype.getData=function(){return[new yk(this.Uc,this.$a.b(),this.Kh)]};xk.prototype.wb=function(){var a=nf(this);a&&(this.Uc=a.bI,this.$a.addAll(a.routes),this.Kh=a.iX)};xk.prototype.nf=function(){return null};var zk=function(){if(!Wc)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}},Ak=Wc&&zk();var Bk=function(){this.Jd=[];this.ce=[]};d=Bk.prototype;d.GX=function(){0==this.Jd.length&&(this.Jd=this.ce,this.Jd.reverse(),this.ce=[])};d.enqueue=function(a){this.ce.push(a)};d.Pf=function(){this.GX();return this.Jd.pop()};d.N=function(){return this.Jd.length+this.ce.length};d.Eb=function(){return 0==this.Jd.length&&0==this.ce.length};d.clear=function(){this.Jd=[];this.ce=[]};d.contains=function(a){return sb(this.Jd,a)||sb(this.ce,a)};
d.remove=function(a){var b;b=this.Jd;var c=kb(b,a);0<=c?(wb(b,c),b=!0):b=!1;return b||xb(this.ce,a)};d.A=function(){for(var a=[],b=this.Jd.length-1;0<=b;--b)a.push(this.Jd[b]);for(var c=this.ce.length,b=0;b<c;++b)a.push(this.ce[b]);return a};var Ck=function(a,b){ve.call(this);this.KF=a||0;this.Ph=b||10;if(this.KF>this.Ph)throw Error("[goog.structs.Pool] Min can not be greater than max");this.Pb=new Bk;this.hg=new Sc;this.Ut=0;this.Qv=null;this.to()};u(Ck,ve);d=Ck.prototype;d.getObject=function(){var a=t();if(!(null!=this.Qv&&a-this.Qv<this.Ut)){var b=this.g1();b&&(this.Qv=a,this.hg.add(b));return b}};d.hi=function(a){return this.hg.remove(a)?(this.Ss(a),!0):!1};
d.g1=function(){for(var a;0<this.HC()&&(a=this.Pb.Pf(),!this.tw(a));)this.to();!a&&this.N()<this.Ph&&(a=this.Ke());return a};d.Ss=function(a){this.hg.remove(a);this.tw(a)&&this.N()<this.Ph?this.Pb.enqueue(a):this.jh(a)};d.to=function(){for(var a=this.Pb;this.N()<this.KF;)a.enqueue(this.Ke());for(;this.N()>this.Ph&&0<this.HC();)this.jh(a.Pf())};d.Ke=function(){return{}};d.jh=function(a){if("function"==typeof a.ab)a.ab();else for(var b in a)a[b]=null};
d.tw=function(a){return"function"==typeof a.KN?a.KN():!0};d.contains=function(a){return this.Pb.contains(a)||this.hg.contains(a)};d.N=function(){return this.Pb.N()+this.hg.N()};d.zS=function(){return this.hg.N()};d.HC=function(){return this.Pb.N()};d.Eb=function(){return this.Pb.Eb()&&this.hg.Eb()};d.K=function(){Ck.R.K.call(this);if(0<this.zS())throw Error("[goog.structs.Pool] Objects not released");delete this.hg;for(var a=this.Pb;!a.Eb();)this.jh(a.Pf());delete this.Pb};var Dk=function(a,b){this.Ye=a;this.Gi=b};Dk.prototype.getKey=function(){return this.Ye};Dk.prototype.$b=function(){return this.Gi};Dk.prototype.clone=function(){return new Dk(this.Ye,this.Gi)};var Ek=function(a){this.pd=[];a&&this.zW(a)};d=Ek.prototype;d.insert=function(a,b){var c=this.pd;c.push(new Dk(a,b));this.dY(c.length-1)};d.zW=function(a){var b;if(a instanceof Ek){if(b=a.bb(),a=a.A(),0>=this.N()){for(var c=this.pd,e=0;e<b.length;e++)c.push(new Dk(b[e],a[e]));return}}else b=Rb(a),a=Qb(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.pd,b=a.length,c=a[0];if(!(0>=b))return 1==b?tb(a):(a[0]=a.pop(),this.cY(0)),c.$b()};
d.cY=function(a){for(var b=this.pd,c=b.length,e=b[a];a<c>>1;){var f=this.HS(a),g=this.vU(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.dY=function(a){for(var b=this.pd,c=b[a];0<a;){var e=this.IT(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.HS=function(a){return 2*a+1};d.vU=function(a){return 2*a+2};d.IT=function(a){return a-1>>1};d.A=function(){for(var a=this.pd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].$b());return b};
d.bb=function(){for(var a=this.pd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.cj=function(a){return nb(this.pd,function(b){return b.$b()==a})};d.Oa=function(a){return nb(this.pd,function(b){return b.getKey()==a})};d.clone=function(){return new Ek(this)};d.N=function(){return this.pd.length};d.Eb=function(){return 0==this.pd.length};d.clear=function(){tb(this.pd)};var Fk=function(){Ek.call(this)};u(Fk,Ek);Fk.prototype.enqueue=function(a,b){this.insert(a,b)};Fk.prototype.Pf=function(){return this.remove()};var Gk=function(a,b){this.dB=void 0;this.qr=new Fk;Ck.call(this,a,b)};u(Gk,Ck);d=Gk.prototype;d.getObject=function(a,b){if(!a)return(a=Gk.R.getObject.call(this))&&this.Ut&&(this.dB=h.setTimeout(r(this.hq,this),this.Ut)),a;this.qr.enqueue(l(b)?b:100,a);this.hq()};d.hq=function(){for(var a=this.qr;0<a.N();){var b=this.getObject();if(b)a.Pf().apply(this,[b]);else break}};d.Ss=function(a){Gk.R.Ss.call(this,a);this.hq()};d.to=function(){Gk.R.to.call(this);this.hq()};
d.K=function(){Gk.R.K.call(this);h.clearTimeout(this.dB);this.qr.clear();this.qr=null};var Hk=function(a,b,c,e){this.Fh=a;this.Li=!!e;Gk.call(this,b,c)};u(Hk,Gk);Hk.prototype.Ke=function(){var a=new $f,b=this.Fh;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.Li&&a.ky(!0);return a};Hk.prototype.tw=function(a){return!a.isDisposed()&&!a.Xe()};var Ik=function(a,b,c,e,f,g){M.call(this);this.$e=l(a)?a:1;this.wf=l(f)?Math.max(0,f):0;this.il=new Hk(b,c,e,g);this.hc=new A;this.Ja=new fi(this)};u(Ik,M);var Jk="ready complete success error abort timeout".split(" ");d=Ik.prototype;d.Or=function(a){this.wf=Math.max(0,a)};d.send=function(a,b,c,e,f,g,k,p,w,B){if(this.hc.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new Kk(b,r(this.DV,this,a),c,e,f,k,l(p)?p:this.$e,w,B);this.hc.set(a,b);a=r(this.tV,this,a);this.il.getObject(a,g);return b};
d.abort=function(a,b){var c=this.hc.get(a);if(c){var e=c.Cs;c.K2(!0);b&&(e&&(this.tH(e,c.Ty),Xe(e,"ready",function(){this.il.hi(e)},!1,this)),this.hc.remove(a));e&&e.abort()}};d.tV=function(a,b){var c=this.hc.get(a);c&&!c.Cs?(this.JM(b,c.Ty),b.Or(this.wf),b.gJ(c.Bk),b.ky(c.Li),c.Cs=b,this.dispatchEvent(new Lk("ready",this,a,b)),this.EH(a,b),c.pz&&b.abort()):this.il.hi(b)};
d.DV=function(a,b){var c=b.target;switch(b.type){case "ready":this.EH(a,c);break;case "complete":return this.AV(a,c,b);case "success":this.cW(a,c);break;case "timeout":case "error":this.nm(a,c);break;case "abort":this.rV(a,c)}return null};d.EH=function(a,b){var c=this.hc.get(a);!c||c.LA||c.sv()?(c&&(this.tH(b,c.Ty),this.hc.remove(a)),this.il.hi(b)):(c.pW(),b.send(c.getUrl(),c.XX,c.dj,c.Np()))};
d.AV=function(a,b,c){var e=this.hc.get(a);if(7==b.kg||b.kd()||e.sv())if(this.dispatchEvent(new Lk("complete",this,a,b)),e&&(e.j3(!0),e.KA))return e.KA.call(b,c);return null};d.rV=function(a,b){this.dispatchEvent(new Lk("abort",this,a,b))};d.cW=function(a,b){this.dispatchEvent(new Lk("success",this,a,b))};d.nm=function(a,b){this.hc.get(a).sv()&&this.dispatchEvent(new Lk("error",this,a,b))};d.tH=function(a,b,c){this.Ja.Xc(a,c||Jk,b)};d.JM=function(a,b,c){this.Ja.listen(a,c||Jk,b)};
d.K=function(){Ik.R.K.call(this);this.il.ab();this.il=null;this.Ja.ab();this.Ja=null;this.hc.clear();this.hc=null};var Lk=function(a,b,c,e){K.call(this,a,b);this.id=c;this.Cs=e};u(Lk,K);var Kk=function(a,b,c,e,f,g,k,p,w){this.rs=a;this.XX=c||"GET";this.dj=e;this.Fh=f||null;this.$e=l(k)?k:1;this.Sz=0;this.pz=this.LA=!1;this.Ty=b;this.KA=g;this.Bk=p||"";this.Li=!!w;this.Cs=null};d=Kk.prototype;d.getUrl=function(){return this.rs};d.Np=function(){return this.Fh};d.Rp=function(){return this.$e};d.pW=function(){this.Sz++};
d.sv=function(){return this.Sz>this.$e};d.j3=function(a){this.LA=a};d.K2=function(a){this.pz=a};var Mk=function(){this.name="unknown";this.state="error";this.EW=null;this.allowStop=!0;this.serviceData=this.li=null;this.extraData={}},Pk=function(a,b,c){this.Wd=a;(a=b)||(Nk||(Nk=new Ik(3,null,1,10,2E3)),a=Nk);this.ko=a;this.jl=[];c||(Ok||(Ok=new Ik(0,null,1,10,15E3)),c=Ok);this.TK=c;this.a=C("mr.dial.Client")};Pk.prototype.abort=function(){this.jl.forEach(function(a){this.ko.abort(a,!0);this.TK.abort(a,!0)},this)};var Nk=null,Ok=null,Qk=999;
Pk.prototype.launchApp=function(a,b){var c=J(),e=(++Qk).toString();this.jl.push(e);this.TK.send(e,this.vu(a),"POST",b,null,0,this.NB("launchApp","POST",e,c));return c.promise};Pk.prototype.MJ=function(a){var b=J(),c=(++Qk).toString();this.jl.push(c);this.ko.send(c,this.vu(a),"DELETE",null,null,0,this.NB("stopApp","DELETE",c,b),0);return b.promise};var Rk=function(a,b){this.SK=a;this.Ae=b;this.h2=!!b&&"running"==b.state};
Pk.prototype.uu=function(a){return new ie(function(b){var c=(++Qk).toString();this.jl.push(c);this.ko.send(c,this.vu(a),"GET",null,null,0,r(this.KY,this,c,b))},this)};
Pk.prototype.KY=function(a,b,c){xb(this.jl,a);a=c.target;Tf(this.a,"GetAppInfo","GET",a,!0);if(a.kd()){c=a.uD();if(!c)if(c=a.Ij(),"undefined"!=typeof DOMParser)c=(new DOMParser).parseFromString(c,"application/xml");else if(Ak){var e=new ActiveXObject("MSXML2.DOMDocument");e.resolveExternals=!1;e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",2048),e.setProperty("MaxElementDepth",256)}catch(p){}e.loadXML(c);c=e}else throw Error("Your browser does not support loading xml documents");
if(c)if((e=c.getElementsByTagName("service"))&&1==e.length){c=new Mk;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.li=k.getAttribute("href"):"options"==k.nodeName?c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)F(this.a,
"GET response missing name value"),b(new Rk(a,null));else if("error"==c.state)F(this.a,"GET response missing state value"),b(new Rk(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.EW=e[1];else if("running"!=c.state&&"stopped"!=c.state){F(this.a,"GET response has invalid state value");b(new Rk(a,null));return}b(new Rk(a,c))}}else F(this.a,"Invalid GET response (invalid service)"),b(new Rk(a,null));else F(this.a,"Empty response"),b(new Rk(a,null))}else F(this.a,"Request to "+
a.Pp()+" failed"),b(new Rk(a,null))};Pk.prototype.vu=function(a){var b=this.Wd.Rf;"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};Pk.prototype.NB=function(a,b,c,e){return r(function(f){xb(this.jl,c);f=f.target;Tf(this.a,a,b,f,!0);f.kd()?e.resolve():e.reject(Error(Uf(f.kg)))},this)};var Sk=function(a,b,c){this.appName=b;this.launchParameter=c||""},Tk=C("mr.DialProvider"),Vk=function(a){if(Ma(a,"urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new Sk(a,c,0<b?a.substring(b+1):void 0):null}else a=Uk(a);return a},Wk=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Xk=/__dialPostData__=([A-Za-z0-9]+={0,2})/,Uk=function(a){var b=(new yj(a)).Tf;if(!b)return null;var c=Wk.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);
if(b=(b=Xk.exec(b))?b[1]:void 0)try{b=Nf(b)}catch(e){return E(Tk,"Invalid base64 encoded postData:"+b),null}return new Sk(a,c,b)};var Yk=function(a,b){this.Fa=a;this.appName=b};var Zk=function(a){this.Sc=new la;this.Ps=a};d=Zk.prototype;d.init=function(){qf(this)};d.clear=function(){this.Sc.clear()};d.add=function(a){this.hC(a.Fa.id)||(this.Sc.set(a.Fa.id,a),this.Ps.iY(a))};d.hC=function(a){return this.Sc.get(a)||null};d.iC=function(a){for(var b=fa(this.Sc),c=b.next();!c.done;c=b.next())if(c=fa(c.value),c.next(),c=c.next().value,c.Fa.sinkId==a)return c;return null};d.c1=function(a){if(a=this.iC(a))this.Sc.delete(a.Fa.id),this.Ps.UF(a)};
d.pH=function(a){var b=this.Sc.get(a);b&&(this.Sc.delete(a),this.Ps.UF(b))};d.Ve=function(){return ja(this.Sc.values(),function(a){return a.Fa})};d.BQ=function(){return ja(this.Sc.values())};d.Ra=function(){return"dial.ActivityRecords"};d.getData=function(){return[ja(this.Sc)]};d.wb=function(){var a=nf(this);a&&(this.Sc=new la(a))};var $k={x9:0,Gaa:1,Q$:2,w9:3},al={ERROR:0,haa:1,EMPTY:2},bl=function(a){kh("MediaRouter.Dial.Create.Route",a,$k)},cl=function(a){kh("MediaRouter.Dial.Device.Description.Failure",a,al)};var dl=function(a,b){this.a=C("mr.dial.AppDiscoveryService");this.gc=new na;this.V=a;this.Gc=b;this.Jb=new la;this.Gt=new la;this.Yd=null;this.Fk=!1};d=dl.prototype;d.init=function(){qf(this)};d.start=function(){F(this.a,"Starting periodic scanning.");this.Fk||(this.Fk=!0,this.mB())};d.stop=function(){F(this.a,"Stopping periodic scanning.");this.Fk&&(this.Fk=!1,this.Yd&&(clearTimeout(this.Yd),this.Yd=null),this.Jb.clear(),this.Gt.forEach(function(a){a.abort()}))};
d.jx=function(a){if(!this.gc.has(a)||this.LM(a))this.gc.add(a),0!=this.V.Yp()&&(this.Fk?this.V.mc().forEach(this.lB.bind(this,a)):this.start())};d.Ey=function(a){this.gc.delete(a)};d.eU=function(){return ja(this.gc)};
d.mB=function(){F(this.a,"Start app status scan.");var a=[];this.V.mc().forEach(function(b){a.push.apply(a,this.vn(b))},this);this.Gc.BQ().forEach(function(b){a.push(this.j2(b))},this);pe(a).Bb(function(){this.Fk&&!this.Yd&&(G(this.a,"Scan complete; scheduling for next scan."),this.Yd=setTimeout(this.wP.bind(this),6E4))},this)};d.wP=function(){G(this.a,"Start app status scan (timer-based)");this.Yd=null;this.mB()};
d.vn=function(a){if(!a.$k)return[];for(var b=[],c=fa(this.gc),e=c.next();!e.done;e=c.next())b.push(this.lB(e.value,a));return b};d.lB=function(a,b){if("unknown"!=b.Kd(a)&&36E5>t()-b.DQ(a)||!b.$k)return H();G(this.a,"Querying "+b.getId()+" for "+a+" to update app status");return this.bC(b,a).then(this.KX.bind(this,b,a))};
d.j2=function(a){var b=this.V.W(a.Fa.sinkId);if(!b)return E(this.a,"Activity refers to nonexistent sink: "+a.Fa.id),H();if(!b.$k)return H();a=a.appName;G(this.a,"Querying "+b.getId()+" for "+a+" to update activity");return this.bC(b,a).then(this.JX.bind(this,b,a))};d.KR=function(a){var b=this.Gt.get(a.getId());b||(b=new Pk(a),G(this.a,"Created DIAL client for "+a.getId()),this.Gt.set(a.getId(),b));return b};
d.bC=function(a,b){var c=el(a,b),e=this.Jb.get(c);if(e)return e;e=this.KR(a).uu(b);this.Jb.set(c,e);e.Bb(function(){this.Jb.delete(c)},this);return e};d.LQ=function(a,b){if(404==b.SK.Qa())return"unavailable";b=b.Ae;if("Netflix"==a)return this.vP(b);switch(b.state){case "running":case "stopped":return"available";default:return"unavailable"}};
d.vP=function(a){return a.extraData&&l(a.extraData.capabilities)&&"websocket"==a.extraData.capabilities&&("running"==a.state||"stopped"==a.state)?"available":"unavailable"};var el=function(a,b){return a.getId()+":"+b};d=dl.prototype;d.KX=function(a,b,c){if(404==c.SK.Qa()||c.Ae){c=this.LQ(b,c);G(this.a,"Got app status "+c+" from "+a.getId()+" for "+b);var e=a.Kd(b);a.Cn(b,c);c!=e&&this.V.rY(b,a)}else E(this.a,"Failed to process app availability; "+a.getId()+" does not support app availability"),a.qJ(!1)};
d.JX=function(a,b,c){(a=this.Gc.iC(a.getId()))&&a.appName==b&&!c.h2&&this.Gc.pH(a.Fa.id)};d.LM=function(a){return this.V.mc().some(function(b){return"unknown"==b.Kd(a)})};d.Ra=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.eU()]};d.wb=function(){var a=nf(this);this.gc=new na(a||[])};var fl=function(){this.configId=this.modelName=this.deviceType=this.ju=this.lu=this.Ao=this.ipAddress=this.friendlyName=this.deviceLabel=this.$n=null};fl.prototype.W7=function(){return this.deviceLabel?this.$n?this.friendlyName?this.ipAddress?this.Ao?this.lu?this.ju?null:"Missing expireTimeMillis":"Missing fetchTimeMillis":"Missing appUrl":"Missing ipAddress":"Missing friendlyName":"Missing uniqueId":"Missing deviceLabel"};
fl.prototype.toString=function(){return JSON.stringify(this,function(a,b){return n(b)&&0==b.indexOf("uuid:")?"***":b})};var il=function(a){this.st=new A;this.Jb=new Sc;this.Pw=new A;var b;(b=a)||(gl||(gl=new Ik(3,null,1,10,2E3)),b=gl);this.ko=b;a||(hl||(hl=new Ik(2,null,1,10,3E3)),a=hl);this.nM=a;this.a=C("mr.dial.DeviceDescriptionService")},gl=null,hl=null;d=il.prototype;
d.HR=function(a){var b=this.ZN(a);return b?(jh("MediaRouter.Dial.Device.Description.Cached"),H(b)):this.Jb.contains(a.deviceLabel)?I(Error("Duplicate request for device "+a.deviceLabel)):this.eQ(a)};d.ZN=function(a){var b=this.st.get(a.deviceLabel);return b?b.configId!=a.configId||t()>=b.ju?(G(this.a,"Removing invalid entry "+b.toString()),this.st.remove(a.deviceLabel),null):b:null};
d.eQ=function(a){var b=J();this.Jb.add(a.deviceLabel);this.ko.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,r(function(c){(c=this.h0(a,c))?b.resolve(c):b.reject(Error("Failed to get device description"))},this));return b.promise};
d.h0=function(a,b){this.Jb.remove(a.deviceLabel);b=b.target;Tf(this.a,"fetchDeviceDescription","GET",b);if(!b.kd())return F(this.a,"Request to "+b.Pp()+" failed"),cl(0),null;var c=b.uD();if(!c)return F(this.a,"Invalid or empty response"),cl(2),null;b=this.p_(b,a,c);if(!b)return cl(1),F(this.a,"Invalid device description"),null;F(this.a,"Got device description for "+b.deviceLabel);G(this.a,"... device description was: "+b.toString());null!=b.configId&&(G(this.a,"Caching device description for "+b.deviceLabel),
this.st.set(a.deviceLabel,b));return b};
d.p_=function(a,b,c){var e=new fl;e.lu=t();e.ju=e.lu+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.Ao=a.getResponseHeader("Application-URL")||null;a=e.Ao;a=a instanceof yj?a.clone():new yj(a,void 0);e.ipAddress=a.Xf();e.deviceType=jl(c,"deviceType");e.modelName=jl(c,"modelName");e.friendlyName=jl(c,"friendlyName");if(a=e.friendlyName)200<a.length&&(a=a.substring(0,197)+"..."),Xa.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ra,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Sa,"&lt;")),-1!=a.indexOf(">")&&
(a=a.replace(Ta,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ua,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Va,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Wa,"&#0;")));e.friendlyName=a;e.$n=jl(c,"UDN");a=e.W7();G(this.a,"Device description: "+kl(c));return a?(E(this.a,"Device description failed to validate ("+a+"): "+JSON.stringify(e)),null):e};
var jl=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},kl=function(a){var b=function(a){for(var b=0,f=a.length;b<f;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
il.prototype.wl=function(a){var b=this.Pw.get(a);if(b)return b.promise;b=J();this.Pw.set(a,b);this.nM.send(a,a,"GET",null,null,0,r(function(c){this.Pw.remove(a);c=c.target;Tf(this.a,"checkAccess","GET",c,!1);b.resolve(c.kd())},this));return b.promise};var ll=function(a,b){this.Ln=a;this.gB=b||new il;this.a=C("mr.dial.SinkDiscoveryService");this.Vd=new A;this.hh=r(this.GY,this);this.wB=r(this.IZ,this);this.Pq=this.Zj=!1},ml={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"};d=ll.prototype;d.init=function(){qf(this)};
d.start=function(){this.Zj||(F(this.a,"Starting..."),chrome.dial?(chrome.dial.onDeviceList.addListener(this.hh),chrome.dial.onError.addListener(this.wB),this.Zj=!0,this.refresh()):(E(this.a,"Dial API not available, aborting start..."),this.Zj=!1))};d.stop=function(){this.Zj?(this.Zj=!1,chrome.dial.onDeviceList.removeListener(this.hh),chrome.dial.onError.removeListener(this.wB)):F(this.a,"Was not started.")};
d.refresh=function(){this.Zj?chrome.dial.discoverNow(r(function(a){F(this.a,"chrome.dial.discoverNow = "+a)},this)):F(this.a,"Not started. Ignoring discover().")};d.GY=function(a){F(this.a,"onDeviceList returned "+a.length+" devices");G(this.a,"....the list is: "+JSON.stringify(a));this.Pq=!1;var b=[],c=new Sc;a.forEach(function(a){b.push(this.i0(a).then(function(a){c.add(a.getId());this.EX(a)},ya,this))},this);oe(b).Bb(function(){this.Pq||this.gr(c)},this)};
d.EX=function(a){if(!this.Pq){G(this.a,"mayAddSink, id = "+a.getId());var b=this.Vd.get(a.getId());b?b.update(a)&&(G(this.a,"Updated sink "+b.getId()),this.Ln.Qc(b)):(G(this.a,"Adding new sink "+a.getId()),Sd(this.a,Kd,"...sink was "+a.WJ()),this.Vd.set(a.getId(),a),this.Ln.Zh(a))}};d.gr=function(a){this.Vd.A().forEach(function(b){a.contains(b.getId())||this.YN(b).then(function(a){a||(this.Ln.cf([b]),this.Vd.remove(b.getId()))},null,this)},this)};d.YN=function(a){return a.Ne?this.gB.wl(a.Ne):H(!1)};
d.i0=function(a){return this.gB.HR(a).then(function(b){var c;b.$n?(c=b.$n,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.$n?Rf.O().Ap(c):a.deviceLabel,f=nl.test(b.modelName);return(new Ji(b.friendlyName,c)).Er(e).X3(b.ipAddress).u3(b.Ao).t3(a.deviceDescriptionUrl).r4(b.modelName).qJ(!f)},null,this)};var nl=/Eureka Dongle|Chromecast Audio/i;d=ll.prototype;
d.IZ=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":E(this.a,"DIAL error: "+a.code+". Clear device list now.");this.Ln.cf(this.Vd.A());this.Vd.clear();this.Pq=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":E(this.a,"DIAL error: "+a.code+". Keep device list.");break;default:E(this.a,"Unhandled DIAL error: "+a.code)}};d.W=function(a){return this.Vd.get(a,null)};
d.IU=function(a){var b=[];this.mc().forEach(function(c){"available"==c.Kd(a)&&b.push(c.ag())});var c=ml[a];return new hk(b,c?[c]:void 0)};d.mc=function(){return this.Vd.A()};d.Yp=function(){return this.Vd.N()};d.rY=function(a,b){this.Ln.Qc(b)};d.Ra=function(){return"dial.DialSinkDiscoveryService"};d.getData=function(){return[this.Vd.b()]};d.wb=function(){var a=nf(this);if(a)for(var b in a)this.Vd.set(b,Ki(a[b]))};var ol=function(a,b,c){this.C=a;this.sc=b||new ll(this);this.Gc=new Zk(this);this.Ic=c||new dl(this.sc,this.Gc);this.Y1=new aj("dial.RouteIdGenerator")};d=ol.prototype;d.a=C("mr.DialProvider");d.getName=function(){return"dial"};d.jd=function(){this.Y1.tB();this.Gc.init();this.sc.init();this.Ic.init();this.Im()};d.Sl=function(a){G(this.a,"GetAvailableSinks for "+a);return(a=Vk(a))?this.sc.IU(a.appName):ik};d.Bi=function(a){if(a=Vk(a))this.Ic.jx(a.appName),this.Im()};
d.Di=function(a){if(a=Vk(a))this.Ic.Ey(a.appName),this.Lq()};d.Ai=function(){this.Im()};d.Ci=function(){this.Lq()};d.Lq=function(){(0==this.sc.Yp()||0==this.Ic.gc.size&&0==this.Gc.Sc.size)&&this.Ic.stop()};d.Im=function(){this.sc.start();0<this.sc.Yp()&&(0<this.Ic.gc.size||0<this.Gc.Sc.size)&&this.Ic.start()};d.W=function(a){return(a=this.sc.W(a))?a.ag():null};d.Ve=function(){return this.Gc.Ve()};
d.ee=function(a,b,c,e){var f=this.sc.W(b);if(!f)return bl(0),I(Error("Unkown sink: "+b));Rf.O().gi=new Qf(f.cc,f.la);var g=Vk(a);if(!g)return I(Error("No app name set."));f.Gr(!0);var k=g.appName,p=new Pk(f);return p.uu(k).then(function(a){if(!a.Ae)throw Error("Failed to get app info");if("running"==a.Ae.state)return p.MJ(k)}).then(function(){return p.launchApp(k,g.launchParameter)}).then(function(){return this.be(b,a,!0,k,c,e)},null,this).na(function(a){bl(3);throw a;}).Bb(function(){f.Gr(!1)})};
d.Ih=function(){return I(Error("no supported"))};d.ah=function(){return I(Error("no supported"))};d.Qf=function(){};d.be=function(a,b,c,e,f,g){bl(1);a=mk(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.Gc.add(new Yk(a,e));return a};d.Zh=function(a){this.C.onSinkAvailabilityUpdated(this,1);this.Im();this.Ic.vn(a);this.C.rc();Rf.O().fi=new Qf(a.cc,a.la)};d.cf=function(a){if(0==this.sc.Yp())this.C.onSinkAvailabilityUpdated(this,0);this.Lq();a.forEach(function(a){this.Gc.c1(a.getId())},this);this.C.rc()};
d.Qc=function(){this.C.rc()};d.iY=function(a){this.Im();this.C.pk(this,a.Fa)};d.UF=function(a){a=a.Fa;if(a.isLocal)this.C.onPresentationConnectionStateChanged(a.id,"terminated");this.Lq();this.C.Xh(this,a)};d.tc=function(a){var b=this.Gc.hC(a);if(!b)return H();this.Gc.pH(a);a=this.sc.W(b.Fa.sinkId);if(!a)return H();(new Pk(a)).MJ(b.appName);return H()};d.$f=function(){return null};d.$l=function(){return null};d.Dg=function(){return I(Error("DIAL sending message is not supported"))};
d.ul=function(a,b){b=this.sc.W(b);return!b||th(a)?!1:(a=Vk(a))?"available"==b.Kd(a.appName):!1};d.Ui=function(){return!1};d.nf=function(){return null};var pl=function(a,b){this.RN=a;this.Wt=b;this.Ff=this.RN.V;this.a=C("mr.cast.CastDialSinkDiscoveryCallbacks")};d=pl.prototype;d.yP=function(a){return this.Ff.wl(a)};d.BD=function(a){var b=this.Ff.W(a.getId());return b?b:(a=a.la)?this.Ff.GU(a,Rf.O().vl||8009):null};d.Zh=function(a){this.BD(a)?Fi(2):this.gK(a);this.Wt.Zh(a)};d.gK=function(a){var b=Ni(a);b&&this.yP(b).then(function(c){c?this.BD(a)?Fi(2):(this.Ff.ro(b),Fi(0)):jh("MediaRouter.Dial.Sink.Discovered.NonCast")},ya,this)};
d.cf=function(a){v(a,function(a){var c=this.Ff.W(a.getId());c&&c.Kl&&this.Ff.ln(a.getId())},this);this.Wt.cf(a)};d.Qc=function(a){var b=this.Ff.W(a.getId());b?b.Kl&&(b.update(a.Xl(),a.la,b.ub(),b.Zc)&&F(this.a,"Updated Cast sink with DIAL sink: "+a.getId()),this.Ff.Qc(b)):this.gK(a);this.Wt.Qc(a)};var ql=function(a,b){this.V=new ll(new pl(b,this));this.Dk=new A;this.C=a;this.Lx=this.yn=0;this.dw=new Sc;this.La=new ol(this,this.V)},rl=/__dialAppName__/;d=ql.prototype;d.getName=function(){return this.La.getName()};d.jd=function(){this.La.jd()};d.Ve=function(){return this.La.Ve()};d.gG=function(){};d.Sl=function(a){return this.La.Sl(a)};d.Bi=function(a){this.La.Bi(a)};d.Di=function(a){this.La.Di(a)};d.Ai=function(a){this.La.Ai(a)};d.Ci=function(a){this.La.Ci(a)};d.W=function(a){return this.La.W(a)};
d.fR=function(a){return new Pk(a)};d.LR=function(a){return this.V.W(a)};
d.tP=function(a,b,c,e){var f=Vk(a),g=this.LR(b);if(!g)return I(Error("Attempting custom launch with closed route"));g.Gr(!0);var k=f.appName;if(!k)return I(Error("No app name given"));var p=null;return this.fR(g).uu(k).then(function(a){if(!a.Ae)return I(Error("Failed to get app info"));p=a.Ae},null,this).then(function(){return this.La.be(b,a,!0,k,e||"",c)},null,this).then(function(b){var c={Fa:b,IE:!1,Ur:g,appName:k,Ae:p,launchParameter:f.launchParameter,session:null,clientId:null};this.Dk.set(b.id,
c);var e=Nj(a);if(!e)return I(Error("No client ID"));this.KO(c,e);return b},null,this).Bb(function(){g.Gr(!1)})};d.KW=function(a){return rl.test(a)};d.ee=function(a,b,c,e,f,g,k){return this.KW(a)?this.tP(a,b,e,c):this.La.ee(a,b,c,e,f,g,k)};
d.tc=function(a){var b=this.Dk.get(a);return b&&b.session&&b.clientId?(a={receiver:this.Mt(b.Ur),action:chrome.cast.ll.STOP},a=new vj("receiver_action",a),a.clientId=b.clientId,this.C.Rd(this,b.Fa.id,a),a=new vj("remove_session",b.session.sessionId,void 0),a.clientId=b.clientId,this.C.Rd(this,b.Fa.id,a),b.IE=!0,H()):this.La.tc(a)};
d.Dg=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.w1(a,e.clientId);case "custom_dial_launch":if(this.dw.contains(e.sequenceNumber))return this.CY(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.tc(a),H()}return this.La.Dg(a,b,c)};d.BT=function(){var a=String(this.Lx);this.Lx=(this.Lx+1)%9007199254740992;return a};
d.KO=function(a,b){var c=this.Mt(a.Ur),e=new vj("receiver_action",{receiver:c,action:chrome.cast.ll.CAST});e.clientId=b;this.C.Rd(this,a.Fa.id,e);c=new chrome.cast.T(this.BT(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new vj("new_session",c);c.clientId=b;this.C.Rd(this,a.Fa.id,c)};
d.CY=function(a,b){this.dw.remove(b.sequenceNumber);b=b.message;a=this.Dk.get(a);if(!a)return I(Error("Unknown route"));if(b&&!b.doLaunch)return H();var c=a.Ur;if(!c)return I(Error("Custom launch response for sink that no longer exists"));var c=new Pk(c),e=a.launchParameter,e=(b?b.launchParameter:null)||e;return c.launchApp(a.appName,e)};d.Mt=function(a){var b=new chrome.cast.Ks(a.getId(),a.Xl());b.ipAddress=a.la;b.receiverType=chrome.cast.no.DIAL;return b};
d.AT=function(){var a=this.yn;this.yn=(this.yn+1)%9007199254740992;return a};d.w1=function(a,b){a=this.Dk.get(a);if(!a)return I(Error("Unknown route"));var c=this.Mt(a.Ur);c.receiverType=chrome.cast.no.DIAL;c=new vj("custom_dial_launch",new chrome.cast.cz(c,a.Ae.state,a.Ae.extraData));c.clientId=b;c.sequenceNumber=this.AT();this.dw.add(c.sequenceNumber);this.C.Rd(this,a.Fa.id,c);return H()};d.$f=function(a){return this.La.$f(a)};d.$l=function(a){return this.La.$l(a)};
d.ul=function(a,b){return this.La.ul(a,b)};d.Ui=function(a,b){return this.La.Ui(a,b)};d.ah=function(a,b,c,e,f){return this.La.ah(a,b,c,e,f)};d.Ih=function(a,b,c,e,f,g){return this.La.Ih(a,b,c,e,f,g)};d.Qf=function(a){var b=this.Dk.get(a);this.Dk.remove(a);b&&b.IE?this.La.tc(a):this.La.Qf(a)};d.rc=function(){this.C.rc()};d.onSinkAvailabilityUpdated=function(a,b){this.C.onSinkAvailabilityUpdated(a,b)};d.pk=function(a,b){this.C.pk(this,b)};d.Xh=function(a,b){this.C.Xh(this,b)};
d.Yh=function(a,b){this.C.Yh(this,b)};d.Rd=function(a,b,c){this.C.Rd(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.C.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.C.onPresentationConnectionClosed(a,b,c)};d.Xu=function(a){return this.C.Xu(a)};d.av=function(){return this.C.av()};d.Se=function(){return this.C.Se()};d.Tq=function(a,b,c){this.C.Tq(this,b,c)};d.Bw=function(a){this.C.Bw(a)};d.Zh=function(a){this.La.Zh(a)};d.cf=function(a){this.La.cf(a)};
d.Qc=function(a){this.La.Qc(a)};d.On=function(){};d.nf=function(a,b){return this.La.nf(a,b)};d.kx=function(a){this.C.kx(a)};d.Fv=function(){return this.C.Fv()};var sl=function(a,b,c){this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,sl);else if(b=Error().stack)this.stack=b;this.errorCode=a};u(sl,Error);var tl=function(a,b){this.routeId=a;this.message=b};var ul=function(a){this.ck=a;this.hf=new Bk};d=ul.prototype;d.enqueue=function(a){this.hf.N()==this.ck&&this.hf.Pf();this.hf.enqueue(a)};d.Pf=function(){return this.hf.Pf()};d.iP=function(){var a=this.hf.A();this.hf.clear();return a};d.Eb=function(){return this.hf.Eb()};d.MW=function(){return this.hf.N()==this.ck};d.A=function(){return this.hf.A()};var vl=function(){this.xk={};this.Yj={};this.a=C("mr.MrRouteMessageSender")};d=vl.prototype;d.gw=function(a){if(this.gE(a))return H(this.lT(a));var b=J();this.Yj[a]=b;return b.promise};d.ty=function(a){(a=this.rx(a))&&a.resolve([])};d.send=function(a,b){if(!this.IX(a,b)){var c=this.xk[a];c||(c=new ul(50),this.xk[a]=c);c.MW()&&(E(this.a,"Queue is full; dropping oldest message"),G(this.a,"   for route "+a));c.enqueue(new tl(a,b))}};d.Xh=function(a){delete this.xk[a];(a=this.rx(a))&&a.reject(Error("Route closed"))};
d.gE=function(a){return!!this.xk[a]&&!this.xk[a].Eb()};d.lT=function(a){return(a=this.xk[a])&&!a.Eb()?a.iP():[]};d.rx=function(a){var b=this.Yj[a];b&&delete this.Yj[a];return b||null};d.IX=function(a,b){var c=this.rx(a);c&&c.resolve([new tl(a,b)]);return!!c};var wl={mz:0,bz:1},xl=function(a){kh("MediaRouter.CastStreaming.Start.Success",a,wl)};var yl=C("mr.mirror.cast.LogUploader"),Al=function(a,b,c){zl("raw_events.log.gz",a,b,c);return b?"https://crash.corp.google.com/samples?stbtiq="+b:""},zl=function(a,b,c,e){if(0==b.size)F(yl,"Trying to upload an empty file to Crash"),e&&e(null);else{var f=new FormData;f.append("prod","Cast");f.append("ver",chrome.runtime.getManifest().version);f.append(a,b);c&&f.append("comments",c);dg("https://clients2.google.com/cr/report",function(a){a=a.target;var b=null;a.kd()?(b=a.Ij(),F(yl,"Upload to Crash succeeded: "+
b)):F(yl,"Upload to Crash failed. HTTP status: "+a.Qa());e&&e(b)},"POST",f,void 0,3E4)}};var Bl=function(){this.wm=0};za(Bl);var Cl=C("mr.mirror.cast.LogUtils");Bl.prototype.j6=function(){var a={fraction:.01,autoSubmitTimeLimitMillis:6048E5},b=a.autoSubmitTimeLimitMillis,c=t();return this.wm&&b&&c-this.wm<b?!1:Math.random()<a.fraction};
var Dl=function(){this.ext="MR";this.senderProductName="Google Chrome";this.senderVersion=qi;this.senderPlatform=bd;this.senderUserAgent=hc||""},El=function(a,b,c,e){var f=new Dl;f.extVersion=chrome.runtime.getManifest().version;f.extChannel="public";f.minBitrate=c.minVideoBitrate;f.maxBitrate=c.maxVideoBitrate;f.resolution=c.WS();f.minResolution=c.mT();f.resolutionChangePolicy=c.mU();f.maxFrameRate=c.maxFrameRate;f.minLatency=c.minLatencyMillis;f.maxLatency=c.maxLatencyMillis;f.animatedLatency=c.animatedLatencyMillis;
f.useDscp=c.dscpEnabled;f.useTdls=c.useTdls;null!==b&&(f.receiverVersion=b);null!==a&&(f.receiverProductName=a);e.length&&(f.Fja=e);return f},Fl=function(a,b,c,e,f){F(Cl,"getRawEvents");var g=J(),k=function(b){F(Cl,"Got receiver version: "+b);b=JSON.stringify(El(c,b,e,f));chrome.cast.streaming.rtpStream.getRawEvents(a,b,function(a){g.resolve(a)})};"Chromecast"==c?lg(b).then(k,g.reject):k(null);return g.promise},Gl=function(a,b,c,e){F(Cl,"getStats");var f=J(),g=function(b){F(Cl,"Got receiver version: "+
b);var g=El(c,b,e,[]);chrome.cast.streaming.rtpStream.getStats(a,function(a){var b={tags:g};Zb(b,a);f.resolve(b)})};"Chromecast"==c?lg(b).then(g,f.reject):g(null);return f.promise};Bl.prototype.Ra=function(){return"mirror.cast.LogUtils"};Bl.prototype.getData=function(){return[null,{lastAutoSubmitMillis:this.wm}]};Bl.prototype.wb=function(){var a=of(this);this.wm=a&&a.lastAutoSubmitMillis||0};var Hl=function(a,b){ei.call(this,a,b)};u(Hl,ei);var Il=function(a){return a&&a.getAudioTracks()&&0<a.getAudioTracks().length?a.getAudioTracks()[0]:null},Jl=function(a){return a&&a.getVideoTracks()&&0<a.getVideoTracks().length?a.getVideoTracks()[0]:null};var Kl=C("mr.NetworkUtils"),Ll=function(a,b){if(!Zh)return I("TDLS feature not enabled.");var c=J();chrome.networkingPrivate.setWifiTDLSEnabledState(a,b,function(a){chrome.runtime.lastError?(Kl.ea("Unable to set TDLS state: state = "+b+", error = "+chrome.runtime.lastError.message),c.reject("Unable to set TDLS state to "+b+".")):(Kl.info("TDLS state changed: state = "+b+", status = "+a),c.resolve(a))});return c.promise};var Ml=function(a,b){this.sessionId=a;this.seqNum=b;this.type="PRESENTATION"};var Nl=function(a,b,c){this.type="GET_STATUS";this.sessionId=a;this.seqNum=b;this.get_status=c};var Ol=function(a,b){this.address=a;this.port=b},Pl=function(a,b){yh.call(this,b);this.a=C("mr.mirror.cast.Session");this.qk=a;this.Ea=a.$f().clone();this.Pd=$g.Ju(b.id);this.H=b.oe.sessionId;this.sd=new Ol(b.oe.AJ,2344);this.lr=b.oe.BJ;this.uc=null;this.Ug=!1;this.Mb=null;this.Ji=!1;this.Kg=0;this.Ca=this.uo=this.vo=null;this.c0=["H264","VP8"];this.wv=new A;this.Uz=null;this.MH=r(this.HZ,this);this.LH=r(this.GZ,this);this.dm=null;this.dn=new hi(30);this.fH=!1;this.bl=null;this.Hx=new aj("mirror.cast.SeqNumGenerator");
this.Ec=this.me=null};u(Pl,yh);d=Pl.prototype;
d.start=function(a){var b=Il(a);a=Jl(a);this.me=new bh("MediaRouter.CastStreaming.Session.Launch");this.Ca=J();this.uW();this.Ea.useTdls&&Ll(this.sd.address,!0).then(function(a){"Connected"!=a&&(this.Ea.useTdls=!1)},function(){this.Ea.useTdls=!1},this);chrome.cast.streaming.session.create(b,a,r(function(a,b,f){this.uc=a;this.Mb=b;this.Kg=f;this.Pd.onMessage=r(this.Uq,this);this.Gx({type:"OFFER",sessionId:this.getId(),seqNum:this.Hx.Sp(),offer:this.Cl()})},this));return this.Ca.promise};
d.stop=function(){this.Ec&&(this.Ec.end(),this.Ec=null);F(this.a,"Stopping "+this.getId());null!==this.uc&&(chrome.cast.streaming.rtpStream.stop(this.uc),chrome.cast.streaming.rtpStream.destroy(this.uc),this.uc=null,this.Ug=!1);null!==this.Mb&&(chrome.cast.streaming.rtpStream.stop(this.Mb),chrome.cast.streaming.rtpStream.destroy(this.Mb),this.Mb=null,this.Ji=!1);this.Kg&&(chrome.cast.streaming.udpTransport.destroy(this.Kg),this.Kg=0);this.Ea.useTdls&&Ll(this.sd.address,!1);this.Ca&&(this.Ca.resolve(this),
this.Ca=null);chrome.cast.streaming.rtpStream.onStarted.removeListener(this.MH);chrome.cast.streaming.rtpStream.onError.removeListener(this.LH);null!==this.dm&&(window.clearTimeout(this.dm),this.dm=null);this.vo=this.uo=null;if(this.bl&&this.bl.onSessionStop)this.bl.onSessionStop(this.sd);return!0};d.j4=function(a){this.Ug&&chrome.cast.streaming.rtpStream.toggleLogging(this.uc,a);this.Ji&&chrome.cast.streaming.rtpStream.toggleLogging(this.Mb,a)};
d.getLogs=function(){if(!this.Ug&&!this.Ji)return I(Error("No streams has been started yet."));var a=[];if(this.Ug){var b=Fl(this.uc,this.sd.address,this.lr,this.Ea,this.dn.A());a.push(b)}this.Ji&&(b=Fl(this.Mb,this.sd.address,this.lr,this.Ea,this.dn.A()),a.push(b));return oe(a).then(function(a){a=new Blob(a,{type:"application/gzip"});F(this.a,"Events blob size: "+a.size);return a},null,this)};
d.getStats=function(){var a=[];if(this.Ug){var b=Gl(this.uc,this.sd.address,this.lr,this.Ea);a.push(b)}this.Ji&&(b=Gl(this.Mb,this.sd.address,this.lr,this.Ea),a.push(b));this.dn.N()&&a.push(H({receiverStatusData:this.dn.A()}));return oe(a).then(function(a){var b={};v(a,function(a){Zb(b,a)});return b})};
d.EO=function(){var a=chrome.cast.streaming.rtpStream.getSupportedParams(this.uc)[0];a.payload.maxLatency=this.Ea.maxLatencyMillis;a.payload.minLatency=this.Ea.minLatencyMillis;a.payload.animatedLatency=this.Ea.animatedLatencyMillis;a.payload.ssrc=Math.floor(499999*Math.random())+1;a.payload.feedbackSsrc=2;a.payload.payloadType=127;a.payload.aesKey=this.vo;a.payload.aesIvMask=this.uo;return a};
d.SO=function(){var a=[];if(null===this.Mb)return a;var b=chrome.cast.streaming.rtpStream.getSupportedParams(this.Mb);this.c0.forEach(function(c){var e=qb(b,function(a){return a.payload.codecName.toLowerCase()==c.toLowerCase()},this);e&&(e.payload.maxFrameRate=this.Ea.maxFrameRate,e.payload.minBitrate=this.Ea.minVideoBitrate,e.payload.maxBitrate=this.Ea.maxVideoBitrate,e.payload.maxLatency=this.Ea.maxLatencyMillis,e.payload.minLatency=this.Ea.minLatencyMillis,e.payload.animatedLatency=this.Ea.animatedLatencyMillis,
e.payload.aesKey=this.vo,e.payload.aesIvMask=this.uo,e.payload.ssrc=Math.floor(499999*Math.random())+500001,e.payload.feedbackSsrc=12,e.payload.payloadType=96,a.push(e))},this);return a};
d.Cl=function(){var a=0,b=[];if(this.uc){var c=this.EO();this.Uz=c;c={index:a,type:"audio_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ea.animatedLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,bitRate:128E3,sampleRate:c.payload.clockRate,timeBase:"1/"+c.payload.clockRate,channels:c.payload.channels,rtpExtensions:["adaptive_playout_delay"]};this.Ea.enableLogging&&Zb(c,{receiverRtcpEventLog:!0});
this.Ea.dscpEnabled&&Zb(c,{receiverRtcpDscp:46});b.push(c);a++}this.SO().forEach(function(c){var f={index:a,type:"video_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ea.animatedLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,maxFrameRate:Math.round(1E3*c.payload.maxFrameRate)+"/1000",timeBase:"1/90000",maxBitRate:c.payload.maxBitrate,resolutions:[{width:this.Ea.maxWidth,height:this.Ea.maxHeight}],
rtpExtensions:["adaptive_playout_delay"]};this.Ea.enableLogging&&Zb(f,{receiverRtcpEventLog:!0});this.Ea.dscpEnabled&&Zb(f,{receiverRtcpDscp:46});b.push(f);this.wv.set(a,c);a++},this);return{supportedStreams:b}};d.HZ=function(a){a==this.uc?this.Ug=!0:a==this.Mb&&(this.Ji=!0);this.Ug&&(null===this.Mb||this.Ji)&&(this.j4(this.Ea.enableLogging),this.Ca&&(this.Ca.resolve(this),this.Ca=null));this.Ec=new gh("MediaRouter.CastStreaming.Session.Length")};
d.GZ=function(a,b){if(a==this.uc)E(this.a,"Audio stream error "+b);else if(a==this.Mb)E(this.a,"Video stream error "+b);else{E(this.a,"Error for stream "+a+": "+b);return}this.Ca&&(this.Ca.reject(Error("Error for stream "+a+": "+b)),this.Ca=null);this.stop()};
d.G6=function(a,b){G(this.a,"Starting streaming ... "+JSON.stringify({udpTransportId:this.Kg,receiverIpEndPoint:this.sd,"audio ID":this.uc,"video ID":this.Mb,"audio params":a,"video params":b}));if(Ea(chrome.cast.streaming.udpTransport.P4)){var c={};this.Ea.dscpEnabled&&(F(this.a,"Enable DSCP in sender."),c.DSCP=!0);chrome.cast.streaming.udpTransport.P4(this.Kg,c)}chrome.cast.streaming.udpTransport.setDestination(this.Kg,{address:this.sd.address,port:this.sd.port});chrome.cast.streaming.rtpStream.onStarted.addListener(this.MH);
chrome.cast.streaming.rtpStream.onError.addListener(this.LH);a&&chrome.cast.streaming.rtpStream.start(this.uc,a);b&&chrome.cast.streaming.rtpStream.start(this.Mb,b)};
d.Uq=function(a){if("urn:x-cast:com.google.cast.webrtc"==a.namespace_){a=a.data;G(this.a,a);var b=JSON.parse(a);if("ANSWER"==b.type&&"ok"==b.result){b.answer.udpPort&&(this.sd.port=b.answer.udpPort);this.fH=!!b.answer.receiverGetStatus;if(this.bl&&this.bl.onAnswer)this.bl.onAnswer(this.sd);this.me&&(this.me.end(),this.me=null);F(this.a,"Starting streaming");var c=this.Uz,e=null;b.answer.sendIndexes&&b.answer.sendIndexes.forEach(function(a){c&&0==a?b.answer.ssrcs&&b.answer.ssrcs[a]&&(c.payload.feedbackSsrc=
b.answer.ssrcs[a]):this.wv.Oa(a)&&(e?E(this.a,"Receiver selected multiple video stream"):(e=this.wv.get(a),b.answer.ssrcs&&b.answer.ssrcs[a]&&(e.payload.feedbackSsrc=b.answer.ssrcs[a])))},this);null!==this.Mb&&null===e&&(E(this.a,"Receiver is capable of video, but did not specify a video stream index in the ANSWER message."),chrome.cast.streaming.rtpStream.destroy(this.Mb),this.Mb=null);if(c||e){this.rD();this.G6(c,e);this.Ca&&(this.Ca.resolve(this),this.Ca=null);return}}if("STATUS_RESPONSE"!=b.type||
null===b.status)this.Ca&&(this.Ca.reject(Error("Invalid answer: "+b)),this.Ca=null),this.stop();else{a={};for(var f in b.status){var g=b.status[f];Ca(g)&&g.length?a[f]=g.pop():a[f]=g}f={};f[(new Date).toISOString()]=a;this.dn.add(f)}}};d.uW=function(){this.uo=Ff(window.crypto.getRandomValues(new Uint8Array(16)));this.vo=Ff(window.crypto.getRandomValues(new Uint8Array(16)))};d.XH=function(){this.Gx(this.UT())};d.Gx=function(a){this.Pd.sendMessage(a,{namespace:"urn:x-cast:com.google.cast.webrtc"})};
d.rD=function(){this.dm=null;if(this.Kg&&this.fH){var a=new Nl(this.getId(),this.Hx.Sp(),["wifiSnr","wifiSpeed","wifiFcsError"]);this.Gx(a);this.dm=window.setTimeout(r(this.rD,this),12E4)}};d.UT=function(){var a=new Ml(this.H,this.Hx.Sp());a.title=this.ox||void 0;a.icons=this.iconUrl&&!this.sq?[new chrome.cast.Image(this.iconUrl)]:[];return a};d.getId=function(){return this.H};d.Ej=function(){return this.qk};d.K=function(){this.Pd.ab();this.stop()};var Ql=function(a){xh.call(this,"cast_streaming",a)};u(Ql,xh);d=Ql.prototype;d.getName=function(){return"cast_streaming"};d.Ej=function(a,b){return new Hl(a,b)};d.Nt=function(a,b){if(a instanceof Hl)return new Pl(a,b);throw Error("Invalid parameters");};d.ix=function(){xl(0)};d.ex=function(){xl(1)};d.fx=function(){jh("MediaRouter.CastStreaming.Session.End")};d.gx=function(a){kh("MediaRouter.CastStreaming.Start.Failure",a,lh)};d.hx=function(){jh("MediaRouter.CastStreaming.Stream.End")};
d.$z=function(){var a=this.Pa,b=a.getLogs().then(function(a){return a},function(a){E(this.m,"Get cast streaming logs failed.",a)},this),a=a.getStats().then(function(a){return a},function(a){E(this.m,"Get cast streaming stats failed.",a)},this),c=J();chrome.metricsPrivate.getIsCrashReportingEnabled(function(a){c.resolve(a)});return oe([b,a,c.promise]).then(function(a){var b=a[0],c=new FileReader;c.onloadend=function(){xf("mr.temp.mirror.cast.Service.mirrorLogs",c.result)};c.readAsBinaryString(b);var k=
a[1];a[2]&&(b&&Bl.O().j6()?Al(b,void 0,this.tY.bind(this)):k&&zl("stats.json",new Blob([JSON.stringify(k)],{type:"application/json"}),void 0,void 0))},null,this)};d.tY=function(a){a&&(Bl.O().wm=t())};d.pT=function(a){F(this.m,"Received message to upload logs for "+a);return this.Pa?this.Pa.getLogs().then(function(b){return Al(b,a)},function(b){E(this.m,"Get cast streaming logs failed.",b);return this.BF(a)},this):H(this.BF(a))};
d.BF=function(a){var b=window.localStorage["mr.temp.mirror.cast.Service.mirrorLogs"];if(!b)return"";window.localStorage.removeItem("mr.temp.mirror.cast.Service.mirrorLogs");F(this.m,"Uploading saved logs for feedback.");for(var c=new Uint8Array(b.length),e=0;e<c.length;e++)c[e]=b.charCodeAt(e);return Al(new Blob([c],{type:"application/gzip"}),a)};var Rl={mz:0,bz:1},Sl=function(a){kh("MediaRouter.WebRtc.Start.Success",a,Rl)};var Ul=function(a,b){ve.call(this);this.a=Qd("cv2.PeerConnection");this.NX=Tl;this.o=this.LO(b);this.ZO=this.GO(a);this.GP=!0;this.cI=J();this.Ix=!1;this.Qq=0;this.lq=null;this.QE=this.uw=0;this.jc=!1;this.$F=this.aG=this.xw=this.hG=this.AY=ya};u(Ul,ve);var Tl={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Vl={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};d=Ul.prototype;d.J4=function(a){this.xw=a};d.I4=function(a){this.aG=a};d.H4=function(a){this.$F=a};
d.L4=function(a){this.hG=a};d.K4=function(a){this.ZO.onmessage=function(b){a(b.data)}};d.Jv=function(){return this.jc};d.LT=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);return b};d.LO=function(a){a=this.LT(a);var b=new webkitRTCPeerConnection(a);b.onicecandidate=r(this.zw,this);b.Cia=r(this.PY,this);b.oniceconnectionstatechange=r(this.OY,this);F(this.a,"Created webkitRTCPeerConnnection with config: "+JSON.stringify(a));return b};
d.GO=function(a){return this.o.createDataChannel(a,{reliable:!1})};d.start=function(){this.jc||(this.jc=!0,this.Cl())};d.stop=function(){F(this.a,"Stopping peer connection...");this.jc&&(this.jc=!1,"closed"!=this.o.signalingState&&this.o.close())};d.addStream=function(a){this.o.addStream(a)};d.removeStream=function(a){this.jc&&this.o.removeStream(a)};d.K=function(){this.stop();this.o=null};
d.Cl=function(){F(this.a,"Sending offer to peer.");var a=this;this.uw=t();this.o.createOffer(r(this.KI,this),function(b){E(a.a,"Error creating offer: "+JSON.stringify(b))},this.NX);this.cI.promise.then(function(b){a.hG(b)})};d.KI=function(a){F(this.a,"Setting local description: "+JSON.stringify(a));var b=this;this.o.setLocalDescription(a,function(){F(b.a,"Local description set successfully")},function(a){E(b.a,"Error setting local description: "+JSON.stringify(a))})};
d.tQ=function(a){return{type:a.type,sdp:a.sdp}};d.setRemoteDescription=function(a){G(this.a,"<===: "+JSON.stringify(a));a=new RTCSessionDescription(a);F(this.a,"Setting remote description: "+JSON.stringify(a));var b=this;this.o.setRemoteDescription(a,function(){F(b.a,"Remote description set successfully.")},function(a){E(b.a,"Error setting remote description: "+JSON.stringify(a))})};
d.zw=function(a){var b=this;a.candidate?(this.Qq++,this.QE=t(),1==this.Qq?this.lq=df(function(){F(b.a,"ICE candidate gathering timed out.");b.lq=null;b.yx()},5E3):this.Ix&&E(this.a,"Received ICE candidate after resolving session description.")):(F(this.a,"End of ICE candidates."),dh("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",t()-this.uw),this.yx(),0<this.Qq&&dh("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.QE-this.uw))};
d.PY=function(){"completed"==this.o.iceGatheringState&&this.yx()};d.yx=function(){ef(this.lq);this.lq=null;this.Ix||(F(this.a,"Resolving sesion description after gathering "+this.Qq+" ICE candidates."),this.cI.resolve(this.tQ(this.o.localDescription)),this.Ix=!0)};
d.OY=function(a){if(this.o){var b=this.o.iceConnectionState;F(this.a,"New ICE connection state: "+b+".");if("connected"==b)this.xw("iceconnected");else if("completed"==b)this.xw("icecompleted");else if("failed"==b)E(this.a,"Ice connection failed: "+JSON.stringify(a)),this.aG("icefailed");else if("closed"==b)this.$F("iceclosed");else if("disconnected"==b)if(E(this.a,"Ice connection state is bad."),this.GP&&this.Jv()){F(this.a,"Restarting ICE.");var c=this;this.o.createOffer(r(this.KI,this),function(a){E(c.a,
"Error creating new offer: "+JSON.stringify(a))},Vl)}else this.AY()}};var Wl=function(a,b){yh.call(this,b);this.qk=a;this.MG=J();this.o=this.MG.promise;this.Pd=$g.Ju(b.id);this.Ca=J();this.Dv=this.jc=!1;this.Ec=this.me=null;this.fy();this.U5();this.Cc(new zh("GET_TURN_CREDENTIALS"))};u(Wl,yh);d=Wl.prototype;d.start=function(a){var b=this;return this.o.then(function(c){if(c.Jv())return I(Error("Mirroring already started"));b.me=new bh("MediaRouter.WebRtc.Session.Launch");c.addStream(a);c.start();return b.Ca.promise})};
d.stop=function(){this.Ec&&this.Ec.end();this.Dv=this.jc=!1;this.me=this.Ec=null;this.o.then(function(a){a.stop()});return!0};d.K=function(){this.Pd.ab();this.stop()};
d.fy=function(){var a=this;this.Pd.onMessage=function(b){if(!b.type)throw Error("Message has no type.");switch(b.type){case "TURN_CREDENTIALS":a.MG.resolve(new Ul(a.Fa.id,b.data.credentials));break;case "ANSWER":a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "KNOCK_ANSWER":a.Dv=!0;a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.Ca.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}}};
d.U5=function(){var a=this;this.o.then(function(b){b.L4(function(b){b=new Bh(a.qk.$f(),Tl,b);a.Cc(new zh("OFFER",b))});b.K4(function(b){a.Cc(Ah(b))});b.J4(function(){a.jc=!0;a.Cc(new zh("SESSION_START_SUCCESS"));!a.Dv&&a.me&&a.me.end();a.me=null;a.Ec=new gh("MediaRouter.WebRtc.Session.Length");a.Ca.resolve(a)});b.H4(function(){a.Cc(new zh("SESSION_END"))});b.I4(function(b){a.jc||a.Ca.reject(b);a.Cc(new zh("SESSION_FAILURE"))})})};var Xl={channelType:"cloud"};
Wl.prototype.Cc=function(a){this.Pd.sendMessage(a,Xl)};Wl.prototype.Ej=function(){return this.qk};var Yl=function(a){xh.call(this,"webrtc",a)};u(Yl,xh);d=Yl.prototype;d.Ej=function(a,b){return new ei(a,b)};d.Nt=function(a,b){if(a instanceof ei)return new Wl(a,b);throw Error("Invalid parameters");};d.ix=function(){Sl(0)};d.ex=function(){Sl(1)};d.fx=function(){jh("MediaRouter.WebRtc.Session.End")};d.gx=function(a){kh("MediaRouter.WebRtc.Start.Failure",a,lh)};d.hx=function(){jh("MediaRouter.WebRtc.Stream.End")};var Zl=function(a,b,c,e,f,g){this.LE=a;this.Vc=b;this.pj=e||null;this.ek=c||null;this.Zd=f||null;this.ki=g||null};d=Zl.prototype;d.Wf=function(){var a="";this.Zd?a=this.Zd:this.ek&&(a=this.ek);return a};d.getId=function(){return this.LE+"@"+this.Vc};d.getService=function(){return this.Vc};d.Xf=function(){return this.pj};d.merge=function(a){!this.ki&&a.ki&&(this.ki=a.ki);!this.Zd&&a.Zd&&(this.Zd=a.Zd);this.Zd&&a.Zd&&this.ki&&(this.Zd=a.Zd)};var $l=function(a,b){this.Sg=a;this.p7=b},am=new $l("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),bm=new $l("https://www.googleapis.com/calendar/v3",""),cm=new $l("https://www.googleapis.com/hangouts/v1",""),dm=new $l("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var em=function(a,b){this.sb=a;this.fb=b;this.a=C("mr.cloud.calendar.CalendarService")};d=em.prototype;d.qQ=function(){var a=this;return this.rR(this.fb.yf,9E5).then(function(b){F(a.a,a.YB(b.length)+" events discovered before filtering.");return a.sS(b)},function(b){E(a.a,"Error getting Hangouts from calendar: "+b);return[]})};d.YB=function(a){return 20<a?"20+":a.toString()};d.rR=function(a,b){var c=t(),e=this;return this.UQ(a,new Date(c),new Date(c+b)).then(function(a){return a.filter(e.RW)})};
d.RW=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.UQ=function(a,b,c){a=this.sb.rj(bm.Sg,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});G(this.a,"Retrieving Hangouts from Calendar: "+a);return this.sb.Vg(a,"GET").then(function(a){return a.items?a.items:[]})};
d.sS=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var f=new yj(e.hangoutLink),g=b.t_(f.qd);if(2==g.length){var f=g[0],g=g[1],k,p;-1!=f.indexOf(".")&&(k=g,p=f);a.push(new Zl(g,f,k,p,e.summary))}else E(b.a,"Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);F(this.a,this.YB(a.length)+" events discovered with Hangout links.");return a};d.t_=function(a){return a.substring(12).split("/")};var fm=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},gm=function(a){this.type=a},hm=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};u(hm,gm);
var im=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},jm={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},km=new im("_stopSession",{},"viewer"),lm=new im("_startWebrtcSession",jm),mm=new im("_knockingStartWebrtcSession",jm,"viewer");var nm=function(a){this.pb=a;this.id=a.id;this.a=C("mr.cloud.devices.CloudDevice")};d=nm.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.NW(),b=this.IW(),c=this.wA(864E5);G(this.a,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}c=this.wA(9E5);F(this.a,"Availability for legacy receiver app: "+c);return c};d.wA=function(a){var b=this.FS();return!!(b&&b>t()-a)};d.IW=function(){return"available"==this.getState().appStatus};
d.NW=function(){return"online"==this.pb.connectionStatus};d.FS=function(){return this.pb.lastUpdateTimeMs?Number(this.pb.lastUpdateTimeMs):null};d.Wf=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.pb.state._cloudCast};d.FE=function(){return this.pb.invitations?0!=this.pb.invitations.length:!1};var om=function(a){this.sb=a};om.prototype.getDevice=function(a){a=this.sb.rj(am.Sg,["devices",a]);return this.sb.Vg(a,"GET").then(function(a){return new nm(a)})};om.prototype.mX=function(){return this.dF({descriptionSubstring:"Chrome Streaming Receiver"})};
om.prototype.dF=function(a){var b=this,c=this.sb.rj(am.Sg,["devices"],a);return this.sb.Vg(c,"GET").then(function(c){var f=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new nm(a)});if(c=c.nextPageToken){var g=Wb(a);g.token=c;return b.dF(g).then(function(a){return f.concat(a)})}return f})};om.prototype.lX=function(){return this.mX().then(function(a){return a.filter(function(a){return a.isAvailable()&&!a.FE()})})};var pm={m8:0,DENIED:1,TIMEOUT:2},qm={iz:0,C9:1},rm={jM:0,NL:1,vba:2,T9:3,S9:4,B$:5,TIMEOUT:6},sm={Q9:0,Taa:1},tm={baa:0,v$:1,kba:2,L9:3},um=function(a){kh("MediaRouter.Cloud.Knock.Result",a,pm)},vm=function(a){kh("MediaRouter.Cloud.Session.Start",a,qm)},wm=function(a){kh("MediaRouter.Cloud.Session.Type",a,sm)},xm=function(a){kh("MediaRouter.Cloud.Device.UserRole",a,tm)};var ym=function(a,b,c,e,f,g,k){var p=Rf.O().Ap(a);this.qc=new Ii(p,b,g,k,f);this.deviceId=a;this.V6=c;this.model=e};ym.prototype.QJ=function(a){return sb(this.V6,a)};var zm=function(a,b,c,e){ym.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.Ns=c};u(zm,ym);var Am=function(a){var b=a.getService();a.Xf()&&(b=a.Xf());var c;a.ek&&a.Wf()!=a.ek&&(c=a.ek);ym.call(this,a.getId(),a.Wf(),["mesi"],"Hangout",b,"hangout",c);this.zx=a.ki||""};u(Am,ym);var Bm=function(a,b){this.J7=a;this.se=b;this.rf=new A;this.Vr=new A;this.zm=null},Cm=function(a,b,c){this.sinks=a;this.HA=b;this.OE=c};d=Bm.prototype;d.mc=function(){this.LN()&&(this.zm=t(),this.Nl());return this.rf.A()};d.ro=function(a){this.rf.set(a.qc.id,a)};d.ln=function(a){return this.rf.remove(a)};d.W=function(a){return this.rf.get(a,null)};d.LN=function(){var a=this.zm+2E4;return null==this.zm||a<t()};d.Nl=function(){var a=this;return this.J7().then(function(b){a.I7(b)})};
d.I7=function(a){var b=new A(this.rf),c=new A,e=new A,f=[],g=[];a.forEach(function(a){var p=a.qc.id;c.set(p,a);e.set(p,a.deviceId);b.Oa(p)?b.Oa(p)&&JSON.stringify(b.get(p))!=JSON.stringify(a)&&g.push(a.qc):f.push(a.qc);b.remove(p)},this);a=b.bb().map(function(a){return b.get(a).qc});this.Vr.clear();this.Vr=e;this.rf.clear();this.rf=c;this.IN(f,g,a)};d.IN=function(a,b,c){0<a.length&&this.se.tG(a);0<b.length&&this.se.rc(b);0<c.length&&this.se.cf(c)};
d.b=function(){return new Cm(this.rf.b(),this.Vr.b(),this.zm)};d.iF=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.model?(e=c.deviceId.split("@"),e=new Am(new Zl(e[0],e[1],c.qc.description,c.qc.domain,c.qc.friendlyName,c.zx))):"Chrome Streaming Receiver"==c.model&&(e=new zm(c.deviceId,c.qc.friendlyName,c.Ns,c.qc.domain));this.rf.set(b,e)}for(b in a.HA)this.Vr.set(b,a.HA[b]);a.OE&&(this.zm=a.OE)};var Dm=function(a,b){this.oO=a;this.Qo=new Bm(this.Nl.bind(this),b);qf(this)};d=Dm.prototype;d.mc=function(){return this.Qo.mc()};d.W=function(a){return this.Qo.W(a)};d.Nl=function(){return this.oO.lX().then(function(a){return a.filter(function(a){return!a.FE()}).map(function(a){jh("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");return new zm(a.getId(),a.Wf(),a.pb.personalizedInfo.maxRole,"default")})})};d.Ra=function(){return"CloudSinkDiscoveryService"};d.getData=function(){return[{cache:this.Qo.b()}]};
d.wb=function(){var a=nf(this);a&&this.Qo.iF(a.cache)};var Em=function(a,b){this.input=a;this.domain=b};var Fm=function(a,b,c){this.DN=a;this.UX=b;this.Oj=new Bm(this.Nl.bind(this),c);this.Hm=new A;qf(this)};Fm.prototype.a=C("mr.cloud.discovery.HangoutSinkDiscoveryService");Fm.prototype.Ts=function(a,b){a=new Zl(a,b,a,b);this.Hm.set(a.getId(),a);return a};Fm.prototype.addManualHangout=Fm.prototype.Ts;Fm.prototype.rH=function(a,b){this.iw(new Zl(a,b,a,b))};Fm.prototype.removeManualHangout=Fm.prototype.rH;d=Fm.prototype;d.mc=function(){return this.Oj.mc()};d.W=function(a){return this.Oj.W(a)};
d.Nl=function(){F(this.a,"Fetching hangouts");var a=this;return pe([this.UX.nQ(),this.DN.qQ()]).then(function(b){var c=y(a.Hm.A());b.forEach(function(b){b.UB?c=c.concat(b.value):D(a.a,"Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];jh("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.iw(b)})})};d.iw=function(a){return new Am(a)};
d.zM=function(a){a=this.Ts(a.input,a.domain);a=this.iw(a);this.Oj.ro(a);return a.qc};d.i1=function(a){return this.Hm.remove(a.deviceId)?(this.Oj.ln(a.qc.id),!0):!1};d.Ra=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){return[{cache:this.Oj.b(),manualHangouts:this.Hm.b()}]};d.wb=function(){var a=nf(this);if(a){this.Oj.iF(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.Hm.set(b,new Zl(c.LE,c.Vc,c.ek,c.pj,c.Zd,c.ki))}}};var Gm=function(a){this.fb=a};d=Gm.prototype;d.rj=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new yj(a+e);c&&(c=Ij(c),a.Jr(c));return a};d.Vg=function(a,b,c){var e=this;return e.fb.getAuthToken().then(function(f){var g=e.KQ(f);return e.EN(g,a,b,c).na(function(g){if("INVALID_ACCESS_ERROR"==g)return e.ZP(f,a,b,c);throw g;})})};d.ZP=function(a,b,c,e){var f=this;return this.fb.YP(a).then(function(){return f.Vg(b,c,e)})};
d.EN=function(a,b,c,e){var f=J(),g=this;a.sendRequest(this.uQ(b,c,function(a){a&&!a.error?f.resolve(a):g.OW(a)?f.reject("INVALID_ACCESS_ERROR"):f.reject(g.q_(a))},e));return f.promise};d.OW=function(a){return!!a&&401==a.error.code};d.KQ=function(a){a=new ri(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.q_=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.uQ=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var Hm=function(){this.qf=!1;this.yf=null;this.Jh=!1;this.a=C("mr.cloud.identity.IdentityService");qf(this);this.nX();this.jJ()};d=Hm.prototype;d.Cv=function(){return"google.com"==this.hV()};d.hV=function(){return this.yf?this.yf.substr(this.yf.indexOf("@")+1):""};d.getAuthToken=function(){return this.fC(!0)};
d.fC=function(a){return chrome.identity?new ie(function(b,c){chrome.identity.getAuthToken({interactive:a},function(a){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==a?c(Error("User is not logged in (no token found)")):b(a)})}):I(Error("chrome.identity permission required for auth."))};d.YP=function(a){return new ie(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.jJ=function(){var a=this;this.fC(!1).then(function(b){chrome.identity.getProfileUserInfo(function(c){a.qf=!!c.email||!!c.id;a.yf=c.email||null;b&&!a.qf&&(a.Jh=!0)})},function(b){G(a.a,"Unable to set sign in and email.",b)})};d.nX=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){a.qf=c;F(a.a,"Signed in change: "+a.qf);a.qf?a.jJ():(a.yf=null,a.Jh=!1)})};
d.T0=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return D(a.a,"gapi not loaded."),!1;F(a.a,"Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.Ra=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.qf,userEmail:this.yf,kioskAuth:this.Jh}]};d.wb=function(){var a=of(this);a&&(a.signedIn&&(this.qf=a.signedIn),a.userEmail&&(this.yf=a.userEmail),a.kioskAuth&&(this.Jh=a.kioskAuth))};var Im={Zy:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},YK:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Jm=Im,Jm=Im;var Lm=function(a,b){var c=["0"];b=Km[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},Km={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Mm={az:".",Hs:",",ez:"%",Ms:"0",AL:"+",sL:"-",dz:"E",fz:"\u2030",Is:"\u221e",xL:"NaN",$y:"#,##0.###",VL:"#E0",zL:"#,##0%",ZK:"\u00a4#,##0.00",bL:"USD"},Nm=Mm,Nm=Mm;var Om=function(a,b,c){this.rm=b||Nm.bL;this.XO=c||0;this.Iq=40;this.Qd=1;this.xi=0;this.Qh=3;this.Oq=this.af=0;this.zJ=this.zK=!1;this.Zm=this.ci="";this.og="-";this.jk="";this.od=1;this.Vh=!1;this.Ch=[];this.ss=this.bB=!1;this.Al=0;this.Zz=null;"number"==typeof a?this.PM(a):this.Oi(a)};d=Om.prototype;d.p4=function(a){if(0<this.xi&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.af=a;return this};d.k4=function(a){this.Qh=a;return this};
d.B5=function(a){if(0<this.af&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.xi=a;return this};d.Oi=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.ci=this.Zq(a,b);var c=b[0];this.P_(a,b);c=b[0]-c;this.Zm=this.Zq(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.od&&(this.Vh=!0),this.og=this.Zq(a,b),b[0]+=c,this.jk=this.Zq(a,b)):(this.og=this.ci+this.og,this.jk+=this.Zm)};
d.PM=function(a){switch(a){case 1:this.Oi(Nm.$y);break;case 2:this.Oi(Nm.VL);break;case 3:this.Oi(Nm.zL);break;case 4:this.Oi(Lm(Nm.ZK,this.rm));break;case 5:this.Oz(1);break;case 6:this.Oz(2);break;default:throw Error("Unsupported pattern type.");}};d.Oz=function(a){this.Al=a;this.Oi(Nm.$y);this.p4(0);this.k4(2);this.B5(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.Al)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.ci,b[0])==b[0],f=a.indexOf(this.og,b[0])==b[0];e&&f&&(this.ci.length>this.og.length?f=!1:this.ci.length<this.og.length&&(e=!1));e?b[0]+=this.ci.length:f&&(b[0]+=this.og.length);a.indexOf(Nm.Is,b[0])==b[0]?(b[0]+=Nm.Is.length,c=Infinity):c=this.A_(a,b);if(e){if(a.indexOf(this.Zm,b[0])!=b[0])return NaN;b[0]+=this.Zm.length}else if(f){if(a.indexOf(this.jk,
b[0])!=b[0])return NaN;b[0]+=this.jk.length}return f?-c:c};
d.A_=function(a,b){var c=!1,e=!1,f=!1,g=1,k=Nm.az,p=Nm.Hs,w=Nm.dz;if(0!=this.Al)throw Error("Parsing of compact style numbers is not implemented");for(var B="";b[0]<a.length;b[0]++){var L=a.charAt(b[0]),U=this.CC(L);if(0<=U&&9>=U)B+=U,f=!0;else if(L==k.charAt(0)){if(c||e)break;B+=".";c=!0}else if(L==p.charAt(0)&&("\u00a0"!=p.charAt(0)||b[0]+1<a.length&&0<=this.CC(a.charAt(b[0]+1)))){if(c||e)break}else if(L==w.charAt(0)){if(e)break;B+="E";e=!0}else if("+"==L||"-"==L)B+=L;else if(1==this.od&&L==Nm.ez.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.od&&L==Nm.fz.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.od&&(g=this.od);return parseFloat(B)/g};d.format=function(a){if(isNaN(a))return Nm.xL;var b=[],c=this.bV(null===this.Zz?a:this.Zz,a);a/=Math.pow(10,c.Xt);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.og:this.ci);isFinite(a)?(a=a*(e?-1:1)*this.od,this.ss?this.S6(a,b):this.vy(a,this.Qd,b)):b.push(Nm.Is);b.push(e?this.jk:this.Zm);b.push(c.PJ);return b.join("")};
d.GH=function(a){var b=Math.pow(10,this.Qh),c=0>=this.xi?Math.round(a*b):Math.round(this.X1(a*b,this.xi,this.Qh));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{uE:a,xQ:b}};
d.vy=function(a,b,c){if(this.af>this.Qh)throw Error("Min value must be less than max value");c||(c=[]);a=this.GH(a);var e=Math.pow(10,this.Qh),f=a.uE,g=a.xQ,k=0==f?0:this.qq(f)+1,p=0<this.af||0<g||this.zJ&&k<this.xi;a=this.af;p&&(a=this.zJ&&0<this.xi?this.xi-k:this.af);for(var w="",k=f;1E20<k;)w="0"+w,k=Math.round(k/10);var w=k+w,B=Nm.az,k=Nm.Ms.charCodeAt(0),L=w.length,U=0;if(0<f||0<b){for(f=L;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.Ch.length)for(b=1;b<this.Ch.length;b++)U+=this.Ch[b];
b=L-U;if(0<b)for(var f=this.Ch,U=L=0,ia,Lb=Nm.Hs,yb=w.length,Mb=0;Mb<yb;Mb++){if(c.push(String.fromCharCode(k+1*Number(w.charAt(Mb)))),1<yb-Mb)if(ia=f[U],Mb<b){var $i=b-Mb;(1===ia||0<ia&&1===$i%ia)&&c.push(Lb)}else U<f.length&&(Mb===b?U+=1:ia===Mb-b-L+1&&(c.push(Lb),L+=ia,U+=1))}else{b=w;w=this.Ch;f=Nm.Hs;ia=b.length;Lb=[];for(L=w.length-1;0<=L&&0<ia;L--){U=w[L];for(yb=0;yb<U&&0<=ia-yb-1;yb++)Lb.push(String.fromCharCode(k+1*Number(b.charAt(ia-yb-1))));ia-=U;0<ia&&Lb.push(f)}c.push.apply(c,Lb.reverse())}}else p||
c.push(String.fromCharCode(k));(this.bB||p)&&c.push(B);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.vz=function(a,b){b.push(Nm.dz);0>a?(a=-a,b.push(Nm.sL)):this.zK&&b.push(Nm.AL);a=""+a;for(var c=Nm.Ms,e=a.length;e<this.Oq;e++)b.push(c);b.push(a)};
d.S6=function(a,b){if(0==a)this.vy(a,this.Qd,b),this.vz(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a/=Math.pow(10,c);var e=this.Qd;if(1<this.Iq&&this.Iq>this.Qd){for(;0!=c%this.Iq;)a*=10,c--;e=1}else 1>this.Qd?(c++,a/=10):(c-=this.Qd-1,a*=Math.pow(10,this.Qd-1));this.vy(a,e,b);this.vz(c,b)}};d.CC=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Nm.Ms.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.Zq=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.rm;else switch(this.XO){case 0:c+=Km[this.rm][1];break;case 2:var g=this.rm,k=Km[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=Km[this.rm][2]}break;case "%":if(!this.Vh&&1!=this.od)throw Error("Too many percent/permill");
if(this.Vh&&100!=this.od)throw Error("Inconsistent use of percent/permill characters");this.od=100;this.Vh=!1;c+=Nm.ez;break;case "\u2030":if(!this.Vh&&1!=this.od)throw Error("Too many percent/permill");if(this.Vh&&1E3!=this.od)throw Error("Inconsistent use of percent/permill characters");this.od=1E3;this.Vh=!1;c+=Nm.fz;break;default:c+=g}}return c};
d.P_=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,p=a.length,w=!0;b[0]<p&&w;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.Ch.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.ss)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.ss=!0;this.Oq=0;b[0]+1<p&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.zK=!0);for(;b[0]+1<p&&"0"==a.charAt(b[0]+1);)b[0]++,this.Oq++;if(1>e+f||1>this.Oq)throw Error('Malformed exponential pattern "'+a+'"');w=!1;break;default:b[0]--,w=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+g;this.Qh=0<=c?a-c:0;0<=c&&(this.af=e+f-c,0>this.af&&(this.af=0));this.Qd=(0<=c?c:a)-e;this.ss&&(this.Iq=e+this.Qd,0==this.Qh&&0==this.Qd&&(this.Qd=1));this.Ch.push(Math.max(0,k));this.bB=
0==c||c==a};var Pm={prefix:"",PJ:"",Xt:0};Om.prototype.MD=function(a,b){var c=1==this.Al?Jm.Zy:Jm.YK;null==c&&(c=Jm.Zy);if(3>a)return Pm;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return Pm;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],PJ:b[3],Xt:a+1-(b[2].length-1)}:Pm:Pm};
Om.prototype.bV=function(a){if(0==this.Al)return Pm;a=Math.abs(a);var b=this.MD(1>=a?0:this.qq(a),"other").Xt;return this.MD(b+this.qq(this.GH(a/Math.pow(10,b)).uE),"other")};Om.prototype.qq=function(a){for(var b=0;1<=(a/=10);)b++;return b};Om.prototype.X1=function(a,b,c){if(!a)return a;b=b-this.qq(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var Qm=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Rm=Qm,Rm=Qm;var Sm=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},Tm=Sm,Tm=Sm;var Um=function(a){this.$j=[];this.Nw=[];this.sw=new Om(1);this.C_(a)},Vm=/'([{}#].*?)'/g,Wm=/''/g;d=Um.prototype;d.format=function(a){return this.yp(a,!1)};d.yp=function(a,b){if(0==this.Nw.length)return"";var c=[];this.su(this.Nw,a,b,c);for(a=c.join("");0<this.$j.length;)a=a.replace(this.pt(this.$j),this.$j.pop());return a};
d.su=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.wQ(g,b,e);break;case 2:g=a[f].value;this.vQ(g,b,c,e);break;case 0:g=a[f].value;this.SB(g,b,Tm,c,e);break;case 1:g=a[f].value;this.SB(g,b,Rm,c,e);break;default:hb("Unrecognized block type: "+a[f].type)}};d.wQ=function(a,b,c){b=b[a];l(b)?(this.$j.push(b),c.push(this.pt(this.$j))):c.push("Undefined parameter - "+a)};
d.vQ=function(a,b,c,e){var f=a.Bo;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.su(f,b,c,e)):e.push("Undefined parameter - "+f)};d.SB=function(a,b,c,e,f){var g=a.Bo,k=a.Qz,p=+b[g];isNaN(p)?f.push("Undefined or invalid parameter - "+g):(k=p-k,g=a[b[g]],l(g)||(c=this.sw.nT?c(k,this.sw.nT()):c(k),g=a[c],l(g)||(g=a.other)),a=[],this.su(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.sw.format(k),f.push(b.replace(/#/g,e))))};d.C_=function(a){a&&(a=this.AW(a),this.Nw=this.ar(a))};
d.AW=function(a){var b=this.$j,c=r(this.pt,this);a=a.replace(Wm,function(){b.push("'");return c(b)});return a=a.replace(Vm,function(a,f){b.push(f);return c(b)})};d.sp=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var Xm=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Ym=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Zm=/^\s*(\w+)\s*,\s*select\s*,/;d=Um.prototype;d.a_=function(a){return Xm.test(a)?0:Ym.test(a)?1:Zm.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.ar=function(a){var b=[];a=this.sp(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.a_(a[c].value)){case 2:e.type=2;e.value=this.H_(a[c].value);break;case 0:e.type=0;e.value=this.D_(a[c].value);break;case 1:e.type=1;e.value=this.B_(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:hb("Unknown block type for pattern: "+a[c].value)}else hb("Unknown part of the pattern.");b.push(e)}return b};
d.H_=function(a){var b="";a=a.replace(Zm,function(a,c){b=c;return""});var c={};c.Bo=b;a=this.sp(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.ar(a[e].value);else hb("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.D_=function(a){var b="",c=0;a=a.replace(Xm,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.Bo=b;e.Qz=c;a=this.sp(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.ar(a[f].value);else hb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.B_=function(a){var b="";a=a.replace(Ym,function(a,c){b=c;return""});var c={};c.Bo=b;c.Qz=0;a=this.sp(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.ar(a[e].value);else hb("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.pt=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var $m=chrome.i18n.getMessage("1522140683318860351"),an=chrome.i18n.getMessage("4246483347873264186"),bn=chrome.i18n.getMessage("5991427458288444010"),cn=chrome.i18n.getMessage("5412436174832024705"),dn=chrome.i18n.getMessage("7735695102441495789"),en=chrome.i18n.getMessage("4575332923598659024"),fn=chrome.i18n.getMessage("2297080986956220930"),gn=new Um(fn),hn=function(a,b){return gn.format({ORGANIZER:a,PARTICIPANTS:b})};var jn=function(a){this.sb=a;this.a=C("mr.cloud.mesi.MesiService")},kn={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};
jn.prototype.nQ=function(){var a=cm.Sg;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.sb.rj(a,["hangouts","search"]);F(this.a,"Retrieving Hangouts from MESI: "+a);return this.sb.Vg(a,"POST",kn).then(function(a){var c=[];a.result&&(c=a.result.map(function(a){var b=a.hangout,c,k;b.external_key?(c=b.external_key.value.replace(/@.*/,""),k=b.external_key.service):b.sharing_url&&(k=b.sharing_url.split("/"),c=k[4],k=k[3]);var p=b.meeting_room_name,w;b.meeting_domain?(w=b.meeting_domain,p&&(c=
p,k=w)):"BUSINESS"==b.type&&b.company_title&&(w=b.company_title.toLowerCase());var B=hn("",0);if((a=a.participant)&&0<a.length){var L=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(L=b.display_name);return a},new Sc);B=hn(L,a.N())}return new Zl(c,k,p,w,B,b.hangout_id)}));return c})};var ln=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},mn=function(a){this.sb=a};mn.$inject=["gapiService"];d=mn.prototype;d.u2=function(a,b,c){var e=this;return this.YH(mm,a,b,c,35E3).then(function(a){return e.ZD(a)})};d.w2=function(a,b,c){var e=this;return this.YH(lm,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.JG(a),new ln(b,a.type,new hm(a.sessionDescription))):new ln(b)})};d.A2=function(a){return this.qe(a,km,{})};
d.YH=function(a,b,c,e,f){c={_settings:c.settings.zy(),_optMediaConstraints:JSON.stringify(c.mediaConstraints),_webrtcMessage:JSON.stringify(new hm(c.description))};e&&(c._user=JSON.stringify(e));return this.qe(b,a,c,f)};d.ZD=function(a){var b=a.state;switch(b){case "done":return H(this.m_(a));case "queued":case "inProgress":var c=this;return c.Y7(a).then(function(a){return c.ZD(a)});default:return H(new ln(b))}};
d.Y7=function(a){var b=this,c=J(),e=setInterval(function(){b.dQ(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c.resolve(a))})},2E3);return c.promise};d.m_=function(a){a=this.JG(a);return"__cloud_webrtc_session_message__"==a.type?new ln("done","knocking_cloud_webrtc_session_message",new hm(a.sessionDescription)):new ln("done",a.type)};
d.qe=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.sb.rj(am.Sg,["commands"],b);return this.sb.Vg(e,"POST",a)};d.JG=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};d.dQ=function(a){a=this.sb.rj(am.Sg,["commands",a]);return this.sb.Vg(a,"GET")};var nn=function(a,b,c,e){this.Re=a;this.fb=b;this.Yn=c;this.fc=e};d=nn.prototype;d.MV=function(a,b,c){var e=this;return this.q2(a,b,c).then(function(a){return e.zV(a,b.id)})};d.FV=function(a){var b=this;return this.Yn.qR().then(function(c){b.fc.ud(new zh("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.q2=function(a,b,c){b=c.deviceId;var e=this.fb.yf,e=e?new fm(e):void 0;a=a.data;switch(c.Ns){case "owner":xm(0);break;case "manager":xm(1);break;case "user":xm(2);break;case "viewer":xm(3)}return"viewer"==c.Ns?this.Re.u2(b,a,e):this.Re.w2(b,a,e)};
d.zV=function(a,b){if("done"!=a.state)return I(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new zh("ANSWER",a.results.sessionDescription);this.fc.ud(a,b);break;case "knocking_cloud_webrtc_session_message":um(0);a=new zh("KNOCK_ANSWER",a.results.sessionDescription);this.fc.ud(a,b);break;case "knock_denied":um(1);this.YD(an,b);break;case "knock_timeout":um(2);this.YD(bn,b);break;default:return I(Error("Invalid message type: "+a.type))}return H()};
d.YD=function(a,b){a=new ah(a,"warning","dismiss");a.Y3(!0);this.fc.Se().send(a);this.fc.ud(new zh("STOP"),b)};var on=function(a,b){this.fb=a;this.fc=b};
on.prototype.JV=function(a,b,c){switch(a.type){case "REFRESH_AUTH":var e=c.deviceId,f=c.zx,g=this;return this.fb.T0().then(function(){g.fc.ud(new zh("AUTH_READY",{hangoutId:e,resolvedId:f}),b.id)});case "LOCAL_PRESENT":return e=c.deviceId,f=c.zx,this.fc.ud(new zh("AUTH_READY",{hangoutId:e,resolvedId:f,conferenceMode:!a.data.local}),b.id),H();case "STATUS_REQUEST":return this.fc.ud(a,b.id),H();case "STATUS_RESPONSE":return this.fc.ud(a,b.id,!0),a.data.routeDescription||this.fc.ud(a,b.id),H();case "HANGOUT_INACTIVE":return this.fc.Fi(b,
4,new ah(dn,"warning","dismiss"));case "HANGOUT_INVALID":return this.fc.Fi(b,3,new ah(en,"warning","dismiss"));default:return I(Error("Unknown type: "+a.type))}};var pn=function(a,b,c){this.Zi=a;this.om=b;this.fc=c};
pn.prototype.j0=function(a,b,c,e){switch(a){case "cloud":break;case "mesi":break;default:return I(Error("Unrecognized channel type"))}if(!b.type)return I(Error("Message has no type"));switch(b.type){case "STOP":return this.fc.Fi(c,1,null);case "SESSION_START_SUCCESS":return vm(0),H();case "SESSION_END":return H();case "SESSION_FAILURE":return vm(1),this.fc.Fi(c,2,new ah($m,"warning","dismiss"));case "__webrtc_stats__":return H();case "OFFER":return this.Zi.MV(b,c,e);case "GET_TURN_CREDENTIALS":return this.Zi.FV(c);
case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":return this.om.JV(b,c,e);default:return I(Error("Unknown type: "+b.type))}};var qn=function(){var a=this;this.a=C("mr.cloud.settings.SettingsService");this.ww=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){if(a.ww){b=fa(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.ww.call(null,c.value);break}}})};d=qn.prototype;d.G4=function(a){this.ww=a};d.o7=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&E(a,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};
d.mR=function(){var a=this;return this.qC().na(function(){return a.qC().na(function(b){E(a.a,"Error retrieving cloud on setting: "+JSON.stringify(b));return!1})})};d.qC=function(){return this.RC("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};d.RC=function(a){var b=J();chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};
d.kR=function(){var a=this;return this.pC().na(function(){return a.pC().na(function(b){E(a.a,"Error retrieving cloud enabled setting: "+JSON.stringify(b));return!1})})};d.pC=function(){return this.ST("media_router.cloudservices.enabled").then(function(a){return!!a.value})};d.ST=function(a){var b=J();chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};
d.F4=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&E(a,"Error setting notified Hangout privacy: "+JSON.stringify(chrome.runtime.lastError))})};d.ET=function(){var a=this;return this.gD().na(function(){return a.gD().na(function(b){E(a.a,"Error retrieving hangouts notified setting: "+JSON.stringify(b));return!1})})};d.gD=function(){return this.RC("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var rn=function(a){this.a=C("mr.cloud.CredentialService");this.sb=a};rn.prototype.qR=function(){var a=this,b=J(),c=dm.Sg+"/iceconfig?key="+dm.p7;F(this.a,"Requesting TURN credentials from "+c);var e=dg(c,function(){return a.UZ(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};rn.prototype.UZ=function(a,b){a.kd()?(F(this.a,"Got TURN credentials: "+a.Ij()),b.resolve(this.LY(a.oU()))):b.resolve(this.MY(null))};
rn.prototype.LY=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:a.credential,username:a.username})})});return b}catch(c){return D(this.a,"Error parsing TURN credentials.",c),[]}};rn.prototype.MY=function(a){D(this.a,"XHR failed fetching TURN credentials.",a instanceof Error?a:void 0);return[]};var sn=function(){this.Yn=this.Ud=this.gk=this.om=this.Zi=this.Re=this.nv=this.tt=this.mw=this.It=this.Ht=this.sb=this.ft=null};za(sn);d=sn.prototype;d.zj=function(){null==this.ft&&(this.ft=new Hm);return this.ft};d.Yl=function(){null==this.sb&&(this.sb=new Gm(this.zj()));return this.sb};d.jR=function(){null==this.Ht&&(this.Ht=new om(this.Yl()));return this.Ht};d.nR=function(a){null==this.It&&(this.It=new Dm(this.jR(),a));return this.It};
d.jT=function(){null==this.mw&&(this.mw=new jn(this.Yl()));return this.mw};d.VQ=function(){null==this.tt&&(this.tt=new em(this.Yl(),this.zj()));return this.tt};d.rS=function(a){null==this.nv&&(this.nv=new Fm(this.VQ(),this.jT(),a));return this.nv};d.IC=function(){null==this.Re&&(this.Re=new mn(this.Yl()));return this.Re};d.lR=function(a){null==this.Zi&&(this.Zi=new nn(this.IC(),this.zj(),this.ZU(),a));return this.Zi};d.kS=function(a){null==this.om&&(this.om=new on(this.zj(),a));return this.om};
d.kT=function(a){null==this.gk&&(this.gk=new pn(this.lR(a),this.kS(a),a));return this.gk};d.DU=function(){null==this.Ud&&(this.Ud=new qn);return this.Ud};d.ZU=function(){null==this.Yn&&(this.Yn=new rn(this.Yl()));return this.Yn};var tn=function(a,b,c){ve.call(this);this.pX=null!=c?r(a,c):a;this.jg=b;this.tl=r(this.QZ,this);this.ct=[]};u(tn,ve);d=tn.prototype;d.Tk=!1;d.Vm=0;d.Cb=null;d.ou=function(a){this.ct=arguments;this.Cb||this.Vm?this.Tk=!0:this.Yt()};d.stop=function(){this.Cb&&(ef(this.Cb),this.Cb=null,this.Tk=!1,this.ct=[])};d.pause=function(){this.Vm++};d.resume=function(){this.Vm--;this.Vm||!this.Tk||this.Cb||(this.Tk=!1,this.Yt())};d.K=function(){tn.R.K.call(this);this.stop()};
d.QZ=function(){this.Cb=null;this.Tk&&!this.Vm&&(this.Tk=!1,this.Yt())};d.Yt=function(){this.Cb=df(this.tl,this.jg);this.pX.apply(null,this.ct)};var vn=function(a){this.Ma={};if(a)for(var b=0;b<a.length;b++)this.Ma[un(a[b])]=null;for(var c in Object.prototype)hb(c+" should not be enumerable in Object.prototype.")},wn={},un=function(a){return a in wn||32==String(a).charCodeAt(0)?" "+a:a},xn=function(a){return 32==a.charCodeAt(0)?a.substr(1):a};d=vn.prototype;d.add=function(a){this.Ma[un(a)]=null};d.rz=function(a){for(var b=0;b<a.length;b++)this.Ma[un(a[b])]=null};d.HM=function(a){for(var b in a.Ma)this.Ma[b]=null};
d.clear=function(){this.Ma={}};d.clone=function(){var a=new vn;a.HM(this);return a};d.contains=function(a){return un(a)in this.Ma};d.equals=function(a){return this.vq(a)&&a.vq(this)};d.forEach=function(a,b){for(var c in this.Ma)a.call(b,xn(c),void 0,this)};d.N=Object.keys?function(){return Object.keys(this.Ma).length}:function(){var a=0,b;for(b in this.Ma)a++;return a};d.A=Object.keys?function(){return Object.keys(this.Ma).map(xn,this)}:function(){var a=[],b;for(b in this.Ma)a.push(xn(b));return a};
d.Eb=function(){for(var a in this.Ma)return!1;return!0};d.vq=function(a){for(var b in this.Ma)if(!(b in a.Ma))return!1;return!0};d.remove=function(a){a=un(a);return a in this.Ma?(delete this.Ma[a],!0):!1};d.zd=function(){return Fc(this.A())};var yn=function(){this.bc=null;this.a=C("mr.IssueSenderImpl")};yn.prototype.init=function(a){this.bc=a};yn.prototype.send=function(a){if(this.bc)if(this.bc.onIssue)this.bc.onIssue(a);else D(this.a,"MediaRouterService.onIssue not defined.");else D(this.a,"MediaRouterService is not set.")};var zn=new Sc;var An=function(a,b){K.call(this,"internal_message");this.routeId=a;this.message=b};u(An,K);var Bn=function(a,b,c){ve.call(this);this.IH=a;this.qe=b;this.VX=c;this.onMessage=ya;c.listen("internal_message",this.Uq,!1,this)};u(Bn,ve);Bn.prototype.sendMessage=function(a,b){return this.qe(this.IH,a,b)};Bn.prototype.Uq=function(a){if(a.routeId==this.IH)this.onMessage(a.message)};Bn.prototype.K=function(){this.VX.Xc("internal_message",this.Uq,!1,this)};var Cn=new Bn("",function(){return H()},new M),Dn=function(a){this.C=a};
Dn.prototype.Ju=function(a){var b=this.C.Xu(a);return b?new Bn(a,r(b.Dg,b),this.C.av()):Cn};var En=function(){this.a=C("mr.ProviderManager");this.Rc=[];this.Tc=new A;this.tn=new A;this.te=new vn;this.oi=new vn;this.ik=new A;this.bc=null;this.Uk=!1;this.JH=new M;this.KH=new tn(this.y2,500,this);this.s6=new tn(this.VP,500,this);this.Mm=new vl;this.Tw=0;this.JE=new yn;this.Vk=new A;this.Nq=-1==window.navigator.userAgent.indexOf("Windows");this.Mq=[];this.createRoute=this.ee;this.joinRoute=this.Ih;this.connectRouteByRouteId=this.ah;this.closeRoute=this.terminateRoute=this.tc;this.startObservingMediaSinks=
this.Bi;this.stopObservingMediaSinks=this.Di;this.sendRouteMessage=this.Dg;this.sendRouteBinaryMessage=this.x2;this.listenForRouteMessages=this.gw;this.stopListeningForRouteMessages=this.ty;this.startObservingMediaRoutes=this.Ai;this.stopObservingMediaRoutes=this.Ci;this.onPresentationSessionDetached=this.detachRoute=this.Qf;this.enableMdnsDiscovery=this.sB;this.searchSinksAndCreateRoute=this.l2;this.searchSinks=this.nf;this.updateMediaSinks=this.B7};d=En.prototype;d.oT=function(a){return this.ik.get(a).Fm().then(function(a){return a})};
d.U0=function(a){a.forEach(this.X0,this)};d.jd=function(a,b){this.ik.set("webrtc",new Ch(new Yl(this)));this.ik.set("cast_streaming",new Ch(new Ql(this)));var c=Yh.O();c.q4(this);c.U3(sn.O().zj());this.ik.set("hangouts",c);c=new Dn(this);$g||($g=c);this.bc=a;this.JE.init(a);this.U0(b);qf(this)};
d.X0=function(a){if(this.Up(a.getName()))E(this.a,"Provider "+a.getName()+" already registered.");else try{a.jd(),this.Rc.push(a),this.Vk.set(a.getName(),0)}catch(b){E(this.a,"Provider "+a.getName()+" failed to initialize.",b)}};
d.Wn=function(a,b){var c=this,e=new Promise(function(e,g){var k=null;b&&(c.f0(),k=window.setTimeout(function(){k=null;g(new sl(1,"timeout after "+b+" ms."));a.cancel()},b));a.then(function(a){null!=k&&window.clearTimeout(k);e(a)},function(a){null!=k&&window.clearTimeout(k);g(a instanceof sl?a:new sl(0,a.message,a.stack))})});b&&(e=e.then(function(a){c.Jz();return a},function(a){c.Jz();throw a;}));return e};d.f0=function(){this.Tw++;this.Jm()};d.Jz=function(){this.Tw--;this.Jm()};
d.ee=function(a,b,c,e,f,g,k){var p=this,w=this.XT(a,b);if(!w)return Promise.reject(new sl(2,"No provider supports createRoute with source: "+a+" and sink: "+b));zn.add(b);this.rc();g=g&&0<g?g:6E4;a=w.ee(a,b,c,k||!1,g,e,f);return this.Wn(a,g).then(function(a){zn.remove(b);p.rc();return a},function(a){D(p.a,"Error creating route.",a);zn.remove(b);p.rc();throw a;})};
d.ah=function(a,b,c,e,f,g){var k=this.Tc.get(b);if(!k)return Promise.reject(new sl(2,"No provider supports join "+b));a=k.ah(a,b,c,e,f);return this.Wn(a,g&&0<g?g:3E4)};d.Ih=function(a,b,c,e,f,g){var k=this.WT(a);if(!k)return Promise.reject(new sl(2,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.Ih(a,b,g||!1,f,c,e);return this.Wn(a,f)};d.tc=function(a){var b=this.Tc.get(a);b?this.AF(a).Bb(function(){b.tc(a)}):E(this.a,"Route "+a+" does not exist.")};
d.Bi=function(a){this.te.contains(a)||(this.te.add(a),this.Rc.forEach(function(b){b.Bi(a)}));this.hr(a)};d.Di=function(a){this.te.remove(a)?this.oB(a):F(this.a,"No existing query "+a)};d.oB=function(a){this.Rc.forEach(function(b){b.Di(a)})};
d.hr=function(a){if("urn:x-org.chromium.media:source:tab:-1"==a)E(this.a,"No sinks for sourceUrn: "+a);else{var b=new A,c=[];this.Rc.forEach(function(e){var f=e.Sl(a);0<f.sinks.length&&(c=f.origins);f.sinks.forEach(function(a){b.Oa(a.id)?E(this.a,"Detected duplicate sink "+a.id+" from provider: "+e.getName()):b.set(a.id,a)},this)},this);this.z2(a,b.A(),c||[])}};d.z2=function(a,b,c){F(this.a,"Sending "+b.length+" sinks to MR for "+a);Fn(b);this.bc.onSinksReceived(a,b,c)};
var Fn=function(a){a.forEach(function(a){a.isLaunching_=zn.contains(a.id)})};d=En.prototype;d.Dg=function(a,b,c){var e=this.Tc.get(a);return e?this.Wn(e.Dg(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.x2=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.gw=function(a){return this.Tc.Oa(a)?this.Wn(this.Mm.gw(a)):Promise.reject(Error("Invalid route ID"))};d.ty=function(a){this.Mm.ty(a)};
d.Qf=function(a){var b=this.Tc.get(a);b?b.Qf(a):F(this.a,"Route "+a+" does not exist.")};d.sB=function(){this.Nq=!0;this.Mq.forEach(function(a){a()});this.Mq.length=0;var a=this;this.te.forEach(function(b){a.hr(b)})};d.XT=function(a,b){return this.Rc.find(function(c){return c.ul(a,b)})||null};d.WT=function(a){return this.Rc.find(function(b){return b.Ui(a)})||null};d.VP=function(){this.te.forEach(function(a){this.hr(a)},this)};d.Jm=function(){this.bc.setKeepAlive(this.iW()||0<this.Tw)};
d.Ai=function(a){this.oi.contains(a)||(this.Uk=!0,this.oi.add(a),this.Rc.forEach(function(b){b.Ai(a)}));this.KH.ou();this.Jm()};d.Ci=function(a){this.oi.remove(a)?(0==this.oi.length&&(this.Uk=!1),this.Rc.forEach(function(b){b.Ci(a)}),this.Jm()):F(this.a,"No existing route query "+a)};
d.y2=function(){if(this.Uk){var a=[];this.Rc.forEach(function(b){a=a.concat(b.Ve())});this.oi.forEach(function(b){var c=[];this.Rc.forEach(function(a){a.Ve().forEach(function(f){!f.fj&&a.Ui(b,f)&&c.push(f.id)})});this.bc.onRoutesUpdated(a,b,c)},this)}};var Gn=function(a,b,c,e,f,g,k){this.r6=b;this.Z1=c;this.m6=e;this.HH=f;this.q6=g;this.MX=k};d=En.prototype;d.Ra=function(){return"ProviderManager"};
d.getData=function(){var a={};this.Tc.forEach(function(b,c){a[c]=b.getName()});return[new Gn(this.Rc.map(function(a){return a.getName()}),this.te.A(),this.oi.A(),this.Uk,a,this.Vk.b(),this.Nq)]};d.wb=function(){var a=nf(this);if(a){this.te.rz(a.r6);this.oi.rz(a.Z1);this.Uk=a.m6;for(var b in a.HH){var c=this.Up(a.HH[b]);this.Tc.set(b,c)}this.Vk.addAll(a.q6);a.MX&&this.sB()}};d.Xu=function(a){return this.Tc.get(a)};d.pk=function(a,b){this.Tc.set(b.id,a);this.Yh(a,b)};
d.Xh=function(a,b){this.AF(b.id);var c=this,e=function(){c.Tc.remove(b.id);c.Mm.Xh(b.id);c.Yh(a,b)};this.Mm.gE(b.id)?df(e,50,this):e()};d.Yh=function(){this.Jm();this.Uk&&this.KH.ou()};d.gG=function(a){var b=this.Tc.get(a.id);b&&this.Yh(b,a)};d.Rd=function(a,b,c){this.Tc.Oa(b)?this.Mm.send(b,JSON.stringify(c)):E(this.a,"Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){this.bc.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){if("function"!=typeof this.bc.onPresentationConnectionClosed)this.onPresentationConnectionStateChanged(a,"closed");else this.bc.onPresentationConnectionClosed(a,b,c)};d.Bw=function(a){this.tn.remove(a);var b=this.Tc.get(a);b&&b.tc(a)};d.Tq=function(a,b,c){this.JH.dispatchEvent(new An(b,c))};d.rc=function(){this.s6.ou()};
d.onSinkAvailabilityUpdated=function(a,b){if("function"==typeof this.bc.onSinkAvailabilityUpdated&&this.Vk.get(a.getName())!=b){var c=this.MA();this.Vk.set(a.getName(),b);a=this.MA();c!=a&&(this.bc.onSinkAvailabilityUpdated(a),0==a&&(this.te.forEach(function(a){this.oB(a)},this),this.te.clear()))}};d.MA=function(){return this.Vk.A().reduce(function(a,b){return Math.max(a,b)},0)};d.av=function(){return this.JH};d.Se=function(){return this.JE};d.iW=function(){return this.Rc.some(function(a){return a.Ve().some(function(a){return a.isLocal})})};
d.AF=function(a){if(this.tn.Oa(a)){var b=this;return this.ik.get(this.tn.get(a)).Fm().then(function(c){b.tn.remove(a);return c.NJ()})}return H(!1)};d.On=function(a,b,c){var e=a.$l(b.sinkId);this.tn.set(b.id,e);return this.ik.get(e).Fm().then(function(e){return e.On(b,b.mediaSource,a.$f(b.sinkId),c)})};d.kx=function(a){this.Nq?a():-1==this.Mq.indexOf(a)&&this.Mq.push(a)};d.Fv=function(){return this.Nq};d.Up=function(a){return this.Rc.find(function(b){return b.getName()==a})||null};
d.nD=function(a){return a.startsWith("pseudo:")?a.substring(7):null};d.l2=function(a,b,c,e,f,g,k,p){var w=this.nD(a),w=w?this.Up(w):null,B=null;w&&(B=w.nf(b,c));if(B)return this.bc.onSearchSinkIdReceived(a,B.id),this.ee(b,B.id,e,f,g,k,p);this.bc.onSearchSinkIdReceived(a,"");return Promise.reject(new sl(0,"No sink found for search input: "+c.input+" and source: "+b))};d.nf=function(a,b,c){a=(a=this.nD(a))?this.Up(a):null;var e=null;a&&(e=a.nf(b,c));return e?e.id:""};
d.B7=function(a){this.te.contains(a)||this.hr(a)};var Hn=function(a){this.C=a;this.$a=new A;this.Mn=[];this.Ud=this.gk=this.fb=this.Re=this.fg=null;this.Pj=this.mk=this.$g=this.Jf=!1;qf(this)};Hn.prototype.a=C("mr.CloudProvider");var In=new Ii("pseudo:cloud","","hangout","Add a hangout","default");d=Hn.prototype;d.getName=function(){return"cloud"};
d.jd=function(){var a=this;F(this.a,"Initializing Cloud MRP");var b=sn.O(),c=b.nR(this);this.Mn.push(c);this.fg=b.rS(this);this.Mn.push(this.fg);this.Re=b.IC();this.fb=b.zj();this.gk=b.kT(this);this.Ud=b.DU();this.Ud.kR().then(function(b){a.Jf=b;F(a.a,"Cloud enabled setting: "+a.Jf)});this.Ud.mR().then(function(b){a.$g=b;F(a.a,"Cloud on setting: "+a.$g)});this.Ud.G4(function(b){a.Jf=b;F(a.a,"Cloud enabled setting: "+a.Jf);a.Jf&&a.rE()});this.Ud.ET().then(function(b){a.mk=b;F(a.a,"Privacy notified setting: "+
a.mk)})};d.Ve=function(){return this.$a.A()};d.Sl=function(a){if(!this.rq(a))return ik;G(this.a,"GetAvailableSinks for "+a);var b=[];if(this.$g||this.k6())b=this.rE();G(this.a,"Available sinks are..."+JSON.stringify(b));b=b.map(function(a){return a.qc});this.fg&&(b=b.concat(In));return new hk(b,-1!=a.indexOf("0F5096E8")?uh:null)};d.rE=function(){var a=[];F(this.a,"Checking cloud discovery services");Rf.O().xq=t();this.Mn.forEach(function(b){b=b.mc();a=a.concat(b)});return a};
d.Bi=function(a){if((this.fb.Jh||this.fb.Cv())&&!this.Pj){var b=Jn(a);F(this.a,"startObservingMediaSinks");G(this.a,"urn: "+a);b&&(this.fg.Ts(b,"google.com"),this.Pj=!0,this.C.rc(),this.C.onSinkAvailabilityUpdated(this,2),F(this.a,"sinkAvailability changed to AVAILABLE"))}};d.Di=function(a){this.rq(a)&&(F(this.a,"stopObservingMediaSinks"),G(this.a,"urn: "+a),(this.fb.Jh||this.fb.Cv())&&this.Pj&&(a=Jn(a)))&&(this.fg.rH(a,"google.com"),this.Pj=!1)};d.Ai=function(){};d.Ci=function(){};
d.W=function(a){return(a=this.vj(a))?a.qc:null};d.ee=function(a,b,c,e,f,g,k){F(this.a,"createRoute called");G(this.a,"urn: "+a+" sinkId:"+b);f=this.vj(b);return this.jp(a,f,b,c,e,g,k)};
d.jp=function(a,b,c,e,f,g,k){var p=this;if(f)return I(Error("not supported"));f=!1;switch(this.Wu(b)){case "cloud":wm(1);break;case "mesi":f=!0,this.mk||(this.mk=!0,this.Ud.F4(),g=new ah(cn,"notification","learn_more"),g.t5(["dismiss"]),g.S3(6320939),this.C.Se().send(g)),wm(0)}Rf.O().gi=new Qf(b.model,null);var w=mk(e,this.getName(),c,a,!0,"",null);f&&(w.customControllerPath="cloud_route_details/view.html?routeId="+w.id);this.$a.set(w.id,w);this.C.pk(this,w);F(this.a,"starting mirroring on route: "+
w.id);w.oe={tabId:k,sessionId:"",AJ:"",BJ:b.model};return this.C.On(this,w).na(function(a){a instanceof he?p.Fi(w,6,null):(D(p.a,"Error on start mirroring",a),p.Fi(w,5,new ah($m,"warning","dismiss")));p.fg&&p.fg.i1(b)&&p.cf([b.qc]);throw a;})};d.tc=function(a){F(this.a,"terminating route: "+a);return(a=this.$a.get(a))?this.Fi(a,0,null):H()};
d.Fi=function(a,b,c){this.$a.remove(a.id);c&&this.Se().send(c);kh("MediaRouter.Cloud.Session.End",b,rm);switch(b){case 1:break;default:this.nO(a)}this.C.Xh(this,a);return H()};d.Dg=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.$a.get(a)||void 0)?this.vj(a.sinkId):void 0;return this.gk.j0(c,b,a,e)}if(n(b)){b=JSON.parse(b);if("STATUS_REQUEST"==b.type||"LOCAL_PRESENT"==b.type||"MUTE"==b.type)return this.ud(b,a),H();if(b.clientId)return this.wV(b,a)}return I(Error("Channel type missing"))};
d.$f=function(){return ci(!0,!0)};d.$l=function(a){var b=null;a=this.vj(a);switch(this.Wu(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}F(this.a,"mirror service: "+b);return b};d.ul=function(a,b){G(this.a,"Checking canRoute: "+a+" for sinkId: "+b);return this.rq(a)&&!!this.W(b)};d.Ui=function(a){return"chrome://media-router/cloudmrp-mirroring"==a};d.Ih=function(a,b){return(a=this.$a.get(b))?H(a):I(Error("not supported"))};d.ah=function(){return I(Error("not supported"))};d.Qf=function(){};
d.tG=function(a){F(this.a,a.length+" sinks added");0<a.length&&!this.$g&&(this.Ud.o7(),this.$g=!0);a=this.vj(a[0].id);Rf.O().fi=new Qf(a.model,null);this.C.rc();this.C.onSinkAvailabilityUpdated(this,2);F(this.a,"sinkAvailability changed to AVAILABLE")};d.cf=function(a){F(this.a,a.length+" sinks removed");this.Mn.some(function(a){return 0<a.mc().length})||(this.C.onSinkAvailabilityUpdated(this,0),F(this.a,"sinkAvailability changed to UNAVAILABLE"));this.C.rc()};
d.rc=function(a){F(this.a,a.length+" sinks updated");this.C.rc()};d.Se=function(){return this.C.Se()};d.ud=function(a,b,c){c?this.C.Rd(this,b,a):this.C.Tq(this,b,a)};d.vj=function(a){var b=null;this.Mn.some(function(c){if(c=c.W(a))return b=c,!!c});return b};d.nO=function(a){a=this.vj(a.sinkId);switch(this.Wu(a)){case "cloud":this.Re.A2(a.deviceId)}};d.Wu=function(a){return a.QJ("cloud")?"cloud":a.QJ("mesi")?"mesi":null};d.k6=function(){var a=Rf.O().xq;return 3E5<=t()-a};
d.rq=function(a){a=th(a);if(this.fb.Jh&&!this.fb.qf&&a)return this.C.onSinkAvailabilityUpdated(this,2),!0;var b=!1;this.Jf&&this.fb.qf&&(b=!0);return b&&a};d.nf=function(a,b){if(!this.rq(a))return null;(a=this.fg.zM(b))&&this.tG([a]);return a};var Jn=function(a){return(a=(new yj(a)).Tf.match("__castMeetingName__=([^/]*)"))?a[1]:null};Hn.prototype.Ra=function(){return"CloudProvider"};Hn.prototype.getData=function(){return[{hasPresentationUrlSink:this.Pj},{cloudEnabled:this.Jf,cloudOn:this.$g,notifiedHangoutsPrivacy:this.mk}]};
Hn.prototype.wb=function(){var a=nf(this);a&&(this.Pj=a.hasPresentationUrlSink);if(a=of(this))a.cloudEnabled&&(this.Jf=a.cloudEnabled),a.cloudOn&&(this.$g=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.mk=a.notifiedHangoutsPrivacy)};
Hn.prototype.wV=function(a,b){var c=a.clientId;return c?("client_connect"==a.type?this.ud({message:{sessionId:"castouts"},clientId:c,type:"new_session"},b,!0):"v2_message"==a.type&&"STOP"==a.message.type&&(this.ud({message:"castouts",clientId:c,type:"remove_session"},b,!0),this.tc(b)),H()):I(Error("Invalid cast message"))};var Kn=C("mr.external.MessageHandler"),Ln=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"],Mn=0,Nn=function(a,b,c,e){if(c.id&&-1!=Ln.indexOf(c.id)){F(Kn,"Received a message from "+c.id+" type: "+b.type);var f=chrome.runtime.id;if("start"==b.type)b=b.message,b=a.nf("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Em(b.meetingName,b.domain)),c="PresentationId"+c.id+Mn++,a.ee("urn:x-org.chromium.media:source:desktop",b,c).then(function(a){e(new mg(f,
"route",a.id))}).catch(function(a){e(new mg(f,"error",a))});else if("stop"==b.type)a.tc(b.message.routeId),e(new mg(f,"stopped"));else return;return!0}};var On=function(){this.XG=r(this.yM,this);this.Id=new oi;this.Id.my=!1;this.Id.Tr=!1;this.zE=this.Id.Nz=!1;this.mF="";this.kQ={}};On.prototype.b3=function(a){if(a!=this.zE){var b=Pd();a?b.wz(this.XG):b.h1(this.XG);this.zE=a}};On.prototype.yM=function(a){if(!this.kQ[a.pF]){var b=this.Id.TB(a),c=Pn;if(c)switch(a.Lh){case Ed:Qn(c,"info",b);break;case Fd:Qn(c,"error",b);break;case Gd:Qn(c,"warn",b);break;default:Qn(c,"debug",b)}else this.mF+=b}};var Pn=h.console,Qn=function(a,b,c){if(a[b])a[b](c);else a.log(c)};var Rn=function(){this.De=new hi(1E3);this.Id=new oi};za(Rn);d=Rn.prototype;d.init=function(){var a=this.xR();Qd("mr").Ok(a);Qd("goog").Ok(Hd);ud(Rd(Qd("browser")));Pd().wz(r(this.cZ,this));this.Id.ny=!0;this.Id.Tr=!0;if(a=window.localStorage["debug.logs"]){var b={all:Ld,fine:Jd,info:Hd,warning:Gd,severe:Fd,off:Dd};Qd("mr").Ok(b[a.toLowerCase()]||Jd)}window.localStorage["debug.console"]&&(a=new On,a.Id.ny=!0,a.Id.Tr=!0,a.Id.my=!0,a.b3(!0))};
d.cZ=function(a){this.De.add(this.Id.TB(a));(a=a.rp)&&a.stack&&this.De.add(a.stack)};d.getLogs=function(){return 0==this.De.N()?"NA":this.De.A().join("")};d.xR=function(){return Hd};d.V0=function(){qf(this)};d.Ra=function(){return"LogManager"};d.getData=function(){return[this.De.A()]};d.wb=function(){var a=this.De.A();this.De.clear();(nf(this)||[]).forEach(function(a){this.De.add(a)},this);a.forEach(function(a){this.De.add(a)},this)};var Sn,Tn=C("mr.Init"),Un=function(a){var b;b=new xk(a);var c=new ql(a,b);b=[b,c];b.push(new Hn(a));return b};Rn.O().init();Sn=new eh("MediaRouter.Provider.WakeDuration");
var Vn=new En,Wn=function(){var a=J();switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a.resolve();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(b){chrome.runtime.lastError||!b.enabled?a.resolve():a.reject("Dev extension is enabled")});break;default:a.reject("Unknown extension id")}return a.promise}().then(function(){if(!chrome.mojoPrivate||!chrome.mojoPrivate.requireAsync)return I(Error("No mojo service loaded"));var a=
J();chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a.resolve({mrService:b,mrInstanceId:c})})});return a.promise}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");F(Tn,"MR instance ID: "+b);a=a.mrService;if(!Vn)throw Error("providerManager not initialized.");a.setHandlers(Vn);sf(b)&&Sn.Pk("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(Sn.end.bind(Sn));
wf(b);Rn.O().V0();b=Un(Vn);ue=function(a){var b=a;b.stack||(b=Error(a));D(Tn,"Unhandled promise rejection.",b)};Vn.jd(a,b)}).na(function(a){E(Tn,a.message);throw a;});
(function(a){chrome.runtime.onMessage.addListener(function(b,c,e){if(c.id==chrome.runtime.id&&"chrome-extension://"+c.id+"/feedback.html"==c.url&&"retrieve_log_data"==b.type){var f={logs:Rn.O().getLogs(),device:Rf.O().$T()},g="Chromecast"==f.device.model?lg(f.device.ip):H();a.oT("cast_streaming").then(function(a){return a.pT(b.source)}).then(function(a){f.castStreamingLogs=a}).Bb(function(){g.then(function(a){a&&(f.device.version=a)}).Bb(function(){e(f)})});return!0}});chrome.runtime.onMessageExternal.addListener(Nn.bind(void 0,
a))})(Vn);Wn.na(function(){window.close()});
